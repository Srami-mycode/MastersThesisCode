
Data<-read.csv("Rconfrontation_data.csv", header=T)
#Creating a subset for the control 
control_subset <- subset(Data, species == "control")
Bacteria species and Fungal species, first testing for normality and then doing ANOVA or WILCOXON (if normality is not met)

###Using Log transformed data for ANOVA analysis 

#control
library("ggpubr")
## Loading required package: ggplot2
ggqqplot(control_subset$log_leaf_avg) #draws the correlation between a given sample and the normal distribution.


shapiro.test(control_subset$log_leaf_avg) #p value needs to be higher than 0.05 to assume normality
## 
##  Shapiro-Wilk normality test
## 
## data:  control_subset$log_leaf_avg
## W = 0.95915, p-value = 0.06314
##Does meet normaility assumtions so we will be testing normality for each species and test the appropriate test, One way ANOVA for species that furfill normality, and WILCOXON for species that do not fulfill normality. 
library(dplyr)
## 
## Attaching package: 'dplyr'
## The following objects are masked from 'package:stats':
## 
##     filter, lag
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
head(Data)
 
 
microbe_
<chr>
soil_space
<chr>
trial
<int>
plate
<int>
seed_replicate
<int>
species
<chr>
species_ID
<chr>
root_length_
<dbl>
1	fungi	inter	1	1	1	Phoma_sp.	301ci57	34.661	
2	fungi	inter	1	1	2	Phoma_sp.	301ci57	26.586	
3	fungi	inter	1	1	3	Phoma_sp.	301ci57	27.990	
4	fungi	inter	1	1	4	Phoma_sp.	301ci57	23.032	
5	fungi	inter	1	1	5	Phoma_sp.	301ci57	24.731	
6	fungi	inter	1	1	6	Phoma_sp.	301ci57	23.193	
6 rows | 1-9 of 16 columns
# Summary statistics for each species
summary_stats <- Data %>%
  group_by(species) %>%
  summarise(
    mean_length = mean(leaf_average_),
    sd_length = sd(leaf_average_),
    n = n()
  )

print(summary_stats)
## # A tibble: 22 × 4
##    species                mean_length sd_length     n
##    <chr>                        <dbl>     <dbl> <int>
##  1 Acidovorax_sp                 5.64     1.65     54
##  2 Alternaria_alternata          5.58     1.45     54
##  3 Anthrobacter_agilis           4.56     0.697    54
##  4 Anuerinibacillus_sp           4.53     0.867    54
##  5 Bacillus_cerus                4.19     1.63     54
##  6 Bacillus_mycodies             4.72     0.557    54
##  7 Bacillus_paramycoides         5.68     1.51     54
##  8 Bacillus_proteolyti           4.98     0.922    54
##  9 Bacillus_thuringiensis        5.69     0.916    54
## 10 Cladosporium_sp.              4.67     0.848    54
## # ℹ 12 more rows
# Facet grid plot for leaf length across microbial species, faceted by type of microbe
ggplot(Data, aes(x = species, y = leaf_average_)) +
  geom_boxplot(aes(fill = species)) +
  facet_wrap(~microbe_) +
  theme_minimal() +
  labs(title = "Leaf Length Across Microbial Species",
       x = "Microbial Species",
       y = "Leaf Length (mm)")


##Need to spread out x axis for species names

# Boxplot to compare leaf lengths with colors
ggplot(Data, aes(x = soil_space, y = leaf_average_, fill = soil_space)) +
  geom_boxplot() +
  theme_minimal() +
  labs(
    title ="Comparison of Leaf Length Between Test Species and Control",
    x = "Soil Space",
    y = "Leaf Length (mm)"
  ) +
  scale_fill_manual(values = c("inter" = "skyblue", "under" = "salmon", "control" = "purple"))+
  theme(
    plot.title = element_text(size = 10) )

# Boxplot to compare leaf lengths with colors
ggplot(Data, aes(x = microbe_, y = leaf_average_, fill = microbe_)) +
  geom_boxplot() +
  theme_minimal() +
  labs(
    title ="Comparison of Leaf Length Between Test Species and Control",
    x = "Microbe type",
    y = "Leaf Length (mm)"
  ) +
  scale_fill_manual(values = c("inter" = "orange", "bacteria" = "pink", "fungi" = "brown"))+
  theme(
    plot.title = element_text(size = 10) )


# Perform ANOVA to compare means among soil space
anova_result <- aov(log_leaf_avg ~ soil_space, data = Data)
summary(anova_result)
##               Df Sum Sq Mean Sq F value  Pr(>F)   
## soil_space     2  0.142 0.07108   4.708 0.00919 **
## Residuals   1239 18.708 0.01510                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#Conclusion:
#The ANOVA results show that the soil_space factor has a statistically significant effect on the log_leaf_avg variable (p = 0.00919). This suggests that the means of log_leaf_avg are significantly different across the levels of soil_space.


# If ANOVA is significant, perform post-hoc Tukey's HSD test
tukey_result <- TukeyHSD(anova_result)
print(tukey_result)
##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = log_leaf_avg ~ soil_space, data = Data)
## 
## $soil_space
##                      diff          lwr          upr     p adj
## inter-control  0.03779186 -0.003045694  0.078629410 0.0765229
## under-control  0.01963783 -0.021518571  0.060794223 0.5020952
## under-inter   -0.01815403 -0.034957261 -0.001350802 0.0305136
# Visualize Tukey's HSD test results
plot(tukey_result)


#Interpretation:
#inter-control:

#Difference: 0.03779186
#Confidence Interval: [-0.003045694, 0.078629410]
#p-value: 0.0765229
#The difference in means between "inter" and "control" is 0.0378. The 95% confidence interval includes zero (-0.003 to 0.079), and the p-value (0.077) is greater than 0.05, suggesting that this difference is not statistically significant at the 5% level.

#under-control:

#Difference: 0.01963783
#Confidence Interval: [-0.021518571, 0.060794223]
#p-value: 0.5020952
#The difference in means between "under" and "control" is 0.0196. The 95% confidence interval includes zero (-0.022 to 0.061), #and the p-value (0.502) is much greater than 0.05, indicating that this difference is not statistically significant.

#under-inter:

#Difference: -0.01815403
#Confidence Interval: [-0.034957261, -0.001350802]
#p-value: 0.0305136
#The difference in means between "under" and "inter" is -0.0182. The 95% confidence interval does not include zero (-0.035 to -0.001), and the p-value (0.031) is less than 0.05, indicating that this difference is statistically significant at the 5% level.

#Summary:
#The only significant difference is between the "under" and "inter" levels of soil_space, with "under" having a significantly #lower mean log_leaf_avg than "inter".
#The comparisons "inter-control" and "under-control" are not statistically significant, meaning there is no strong evidence to #suggest that their means differ.
"Acidovorax_sp."
## [1] "Acidovorax_sp."
#Creating a Acidovorax_sp subset from data 
Acidovorax_sp.data <- subset(Data, species == "Acidovorax_sp")
summary(Acidovorax_sp.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 7.464   Length:54         
##  Class :character   Class :character   1st Qu.:14.636   Class :character  
##  Mode  :character   Mode  :character   Median :18.851   Mode  :character  
##                                        Mean   :19.611                     
##                                        3rd Qu.:24.459                     
##                                        Max.   :38.849                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.329   Min.   :0.5222   Min.   :4.000   Min.   :1.000  
##  1st Qu.:4.429   1st Qu.:0.6463   1st Qu.:4.250   1st Qu.:3.000  
##  Median :5.222   Median :0.7178   Median :6.000   Median :4.000  
##  Mean   :5.638   Mean   :0.7342   Mean   :5.519   Mean   :4.389  
##  3rd Qu.:6.857   3rd Qu.:0.8357   3rd Qu.:6.000   3rd Qu.:6.000  
##  Max.   :9.300   Max.   :0.9685   Max.   :8.000   Max.   :9.000  
##   stem_length       log_stem     
##  Min.   :1.583   Min.   :0.1995  
##  1st Qu.:2.503   1st Qu.:0.3985  
##  Median :2.904   Median :0.4630  
##  Mean   :2.902   Mean   :0.4526  
##  3rd Qu.:3.324   3rd Qu.:0.5217  
##  Max.   :4.916   Max.   :0.6916
ggqqplot(Acidovorax_sp.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(control_subset$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  control_subset$log_leaf_avg
## W = 0.95915, p-value = 0.06314
#p value needs to be higher than 0.05 to assume normality
#p-value = 0.06314, fufrills normality assumtions

anova_result <- aov(log_leaf_avg ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Acidovorax_sp.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects

summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.05135 0.05135               
## 
## Error: trial:plate
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.05439 0.05439               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1 0.1639 0.16394   18.87 3.26e-05 ***
## Residuals 104 0.9035 0.00869                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#Pvalue is 3.26e-05,there is significant difference.



#Plot
x<-(control_subset$leaf_average)
y<-(Acidovorax_sp.data$leaf_average)

data <- data.frame(
  Group = rep(c("Control", "Acidovorax_sp"), each = length(x)),
  Value = c(x, y)
)
# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Acidovorax_sp VS Control Leaf Length",
       x = "Group",
       y = "Leaf Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Acidovorax_sp" = "lightgreen"))

p 


"Anthrobacter_agilis"
## [1] "Anthrobacter_agilis"
Anthrobacter_agilis.data <- subset(Data, species == "Anthrobacter_agilis")
summary(Anthrobacter_agilis.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length   
##  Length:54          Length:54          Min.   : 0.00   Length:54         
##  Class :character   Class :character   1st Qu.:11.50   Class :character  
##  Mode  :character   Mode  :character   Median :15.35   Mode  :character  
##                                        Mean   :17.66                     
##                                        3rd Qu.:22.93                     
##                                        Max.   :47.28                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.341   Min.   :0.5239   Min.   :4.000   Min.   :0.000  
##  1st Qu.:4.083   1st Qu.:0.6110   1st Qu.:4.000   1st Qu.:1.000  
##  Median :4.454   Median :0.6487   Median :6.000   Median :2.000  
##  Mean   :4.562   Mean   :0.6543   Mean   :5.333   Mean   :2.037  
##  3rd Qu.:5.106   3rd Qu.:0.7080   3rd Qu.:6.000   3rd Qu.:3.000  
##  Max.   :6.296   Max.   :0.7991   Max.   :6.000   Max.   :6.000  
##   stem_length       log_stem     
##  Min.   :1.476   Min.   :0.1691  
##  1st Qu.:2.262   1st Qu.:0.3544  
##  Median :2.522   Median :0.4017  
##  Mean   :2.585   Mean   :0.4040  
##  3rd Qu.:2.781   3rd Qu.:0.4442  
##  Max.   :4.273   Max.   :0.6307
ggqqplot(Anthrobacter_agilis.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Anthrobacter_agilis.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Anthrobacter_agilis.data$log_leaf_avg
## W = 0.98362, p-value = 0.666
#p= 0.666, furfills normality assumtions 

anova_result <- aov(log_leaf_avg ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Anthrobacter_agilis.data ))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.006199 0.006199               
## 
## Error: trial:plate
##           Df    Sum Sq   Mean Sq F value Pr(>F)
## Residuals  1 0.0005645 0.0005645               
## 
## Error: Within
##            Df Sum Sq  Mean Sq F value Pr(>F)
## species     1 0.0001 0.000105   0.024  0.878
## Residuals 104 0.4601 0.004424
#p value=0.878, leaf length in this species is not significantly different than control, 
#"Anuerinibacillus_sp."

#Create a subset 
Anuerinibacillus_sp.data <- subset(Data, species == "Anuerinibacillus_sp")
ggqqplot(Anuerinibacillus_sp.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Anuerinibacillus_sp.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Anuerinibacillus_sp.data$log_leaf_avg
## W = 0.98759, p-value = 0.8467
#p= 0.846 furfills normality assumtions 


anova_result <- aov(log_leaf_avg ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Anuerinibacillus_sp.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.01884 0.01884               
## 
## Error: trial:plate
##           Df    Sum Sq   Mean Sq F value Pr(>F)
## Residuals  1 0.0002292 0.0002292               
## 
## Error: Within
##            Df Sum Sq  Mean Sq F value Pr(>F)
## species     1 0.0016 0.001621   0.292   0.59
## Residuals 104 0.5765 0.005543
#p-value= 0.59, not significantly different.
"Bacillus_albus"
## [1] "Bacillus_albus"
#Create a subset 
Bacillus_albus.data <- subset(Data, species == "bacillus_albus")
summary(Bacillus_albus.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length   
##  Length:54          Length:54          Min.   : 7.48   Length:54         
##  Class :character   Class :character   1st Qu.:16.75   Class :character  
##  Mode  :character   Mode  :character   Median :20.48   Mode  :character  
##                                        Mean   :21.94                     
##                                        3rd Qu.:28.02                     
##                                        Max.   :43.76                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.375   Min.   :0.5283   Min.   :4.000   Min.   :2.000  
##  1st Qu.:4.827   1st Qu.:0.6837   1st Qu.:4.500   1st Qu.:4.000  
##  Median :5.281   Median :0.7227   Median :6.000   Median :5.000  
##  Mean   :5.338   Mean   :0.7219   Mean   :5.481   Mean   :5.148  
##  3rd Qu.:5.948   3rd Qu.:0.7744   3rd Qu.:6.000   3rd Qu.:6.000  
##  Max.   :7.104   Max.   :0.8515   Max.   :6.000   Max.   :9.000  
##   stem_length       log_stem     
##  Min.   :1.511   Min.   :0.1793  
##  1st Qu.:2.144   1st Qu.:0.3312  
##  Median :2.372   Median :0.3751  
##  Mean   :2.416   Mean   :0.3755  
##  3rd Qu.:2.721   3rd Qu.:0.4347  
##  Max.   :3.757   Max.   :0.5748
ggqqplot(Bacillus_albus.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Bacillus_albus.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Bacillus_albus.data$log_leaf_avg
## W = 0.97789, p-value = 0.4152
# p-value = 0.4152, furfills normality assumtions 


anova_result <- aov(log_leaf_avg ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Bacillus_albus.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.01083 0.01083               
## 
## Error: trial:plate
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.003681 0.003681               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1 0.1163  0.1163   24.73 2.62e-06 ***
## Residuals 104 0.4893  0.0047                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# p-value=2.62e-06, suggesting significant difference of leaf length measurements among this species and control 



#Plot
x<-(control_subset$leaf_average_)
y<-(Bacillus_albus.data$leaf_average_)

data <- data.frame(
  Group = rep(c("Control", "Bacillus_albus"), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Bacillus albus VS Control leaf length",
       x = "Group",
       y = "Leaf Length mm") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Bacillus_albus" = "lightgreen"))

p


"Bacillus_cerus"
## [1] "Bacillus_cerus"
#Create a subset 
Bacillus_cerus.data <- subset(Data, species == "Bacillus_cerus")
summary(Bacillus_cerus.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 4.737   Length:54         
##  Class :character   Class :character   1st Qu.:15.139   Class :character  
##  Mode  :character   Mode  :character   Median :22.985   Mode  :character  
##                                        Mean   :22.380                     
##                                        3rd Qu.:27.363                     
##                                        Max.   :41.627                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :1.361   Min.   :0.1339   Min.   :4.000   Min.   :2.000  
##  1st Qu.:2.778   1st Qu.:0.4438   1st Qu.:5.000   1st Qu.:4.000  
##  Median :4.443   Median :0.6476   Median :6.000   Median :5.000  
##  Mean   :4.189   Mean   :0.5836   Mean   :5.463   Mean   :4.778  
##  3rd Qu.:5.395   3rd Qu.:0.7319   3rd Qu.:6.000   3rd Qu.:6.000  
##  Max.   :7.622   Max.   :0.8820   Max.   :6.000   Max.   :9.000  
##   stem_length       log_stem      
##  Min.   :1.235   Min.   :0.09167  
##  1st Qu.:2.248   1st Qu.:0.35172  
##  Median :2.503   Median :0.39855  
##  Mean   :2.568   Mean   :0.39978  
##  3rd Qu.:2.938   3rd Qu.:0.46808  
##  Max.   :3.789   Max.   :0.57852
ggqqplot(Bacillus_cerus.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Bacillus_cerus.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Bacillus_cerus.data$log_leaf_avg
## W = 0.93034, p-value = 0.003766
# p-value= 0.00376 , does not furfills normality assumtions.


# Perform the Wilcoxon Rank Sum Test
wilcox_test <- wilcox.test(log_leaf_avg ~ species, data = rbind(control_subset, Bacillus_cerus.data))
print(wilcox_test)
## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  log_leaf_avg by species
## W = 1298, p-value = 0.3271
## alternative hypothesis: true location shift is not equal to 0
#p-value = 0.3271 not significantly different, fail to reject the null hypothesis that there are no differences among Bacillus cerus leaf length versus the control. 
"Bacillus_mycodies"
## [1] "Bacillus_mycodies"
#Create a subset 
Bacillus_mycodies.data <- subset(Data, species == "Bacillus_mycodies")
summary(Bacillus_mycodies.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 9.423   Length:54         
##  Class :character   Class :character   1st Qu.:17.397   Class :character  
##  Mode  :character   Mode  :character   Median :26.843   Mode  :character  
##                                        Mean   :27.347                     
##                                        3rd Qu.:32.766                     
##                                        Max.   :64.685                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.624   Min.   :0.5592   Min.   :4.000   Min.   :1.000  
##  1st Qu.:4.407   1st Qu.:0.6441   1st Qu.:6.000   1st Qu.:3.000  
##  Median :4.673   Median :0.6696   Median :6.000   Median :4.000  
##  Mean   :4.724   Mean   :0.6714   Mean   :5.704   Mean   :3.981  
##  3rd Qu.:5.015   3rd Qu.:0.7002   3rd Qu.:6.000   3rd Qu.:5.000  
##  Max.   :6.074   Max.   :0.7834   Max.   :6.000   Max.   :8.000  
##   stem_length       log_stem     
##  Min.   :2.022   Min.   :0.3058  
##  1st Qu.:2.781   1st Qu.:0.4442  
##  Median :3.188   Median :0.5036  
##  Mean   :3.249   Mean   :0.5026  
##  3rd Qu.:3.715   3rd Qu.:0.5699  
##  Max.   :5.402   Max.   :0.7326
ggqqplot(Bacillus_mycodies.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Bacillus_mycodies.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Bacillus_mycodies.data$log_leaf_avg
## W = 0.9849, p-value = 0.7267
#furfills normality assumtions, p-value = 0.7267 


anova_result <- aov(log_leaf_avg ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Bacillus_mycodies.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.006637 0.006637               
## 
## Error: trial:plate
##           Df    Sum Sq   Mean Sq F value Pr(>F)
## Residuals  1 4.371e-05 4.371e-05               
## 
## Error: Within
##            Df Sum Sq  Mean Sq F value Pr(>F)
## species     1 0.0062 0.006164   1.728  0.192
## Residuals 104 0.3709 0.003567
# p-value= 2.62e-06, suggesting significantly different leaf lengths from control. 


#Plot
x<-(control_subset$leaf_average_)
y<-(Bacillus_mycodies.data$leaf_average_)

data <- data.frame(
  Group = rep(c("Control", "Bacillus_mycodies"), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Bacillus_mycodies vs control leaf length mm",
       x = "Group",
       y = "Leaf leangth Length mm") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Bacillus_mycodies" = "lightgreen"))

p


"Bacillus paramycoides" 
## [1] "Bacillus paramycoides"
#Create a subset 
Bacillus_paramycoides.data <- subset(Data, species == "Bacillus_paramycoides")
summary(Bacillus_paramycoides.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 6.373   Length:54         
##  Class :character   Class :character   1st Qu.:11.190   Class :character  
##  Mode  :character   Mode  :character   Median :14.354   Mode  :character  
##                                        Mean   :14.733                     
##                                        3rd Qu.:16.812                     
##                                        Max.   :29.675                     
##  leaf_average_     log_leaf_avg      leaf_count    lateral_roots   
##  Min.   : 3.818   Min.   :0.5818   Min.   :2.000   Min.   : 1.000  
##  1st Qu.: 4.654   1st Qu.:0.6678   1st Qu.:4.000   1st Qu.: 1.250  
##  Median : 5.167   Median :0.7133   Median :6.000   Median : 2.000  
##  Mean   : 5.678   Mean   :0.7413   Mean   :5.222   Mean   : 2.741  
##  3rd Qu.: 6.359   3rd Qu.:0.8033   3rd Qu.:6.000   3rd Qu.: 3.000  
##  Max.   :11.180   Max.   :1.0484   Max.   :6.000   Max.   :12.000  
##   stem_length       log_stem     
##  Min.   :1.372   Min.   :0.1374  
##  1st Qu.:2.316   1st Qu.:0.3648  
##  Median :2.650   Median :0.4232  
##  Mean   :2.593   Mean   :0.4042  
##  3rd Qu.:2.864   3rd Qu.:0.4569  
##  Max.   :3.801   Max.   :0.5799
ggqqplot(Bacillus_paramycoides.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Bacillus_paramycoides.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Bacillus_paramycoides.data$log_leaf_avg
## W = 0.94035, p-value = 0.009642
#p-value = 0.009642, does not furfill normality assumtions 

# Perform the Wilcoxon Rank Sum Test
wilcox_test <- wilcox.test(log_leaf_avg ~ species, data = rbind(control_subset, Bacillus_paramycoides.data))
print(wilcox_test)
## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  log_leaf_avg by species
## W = 2161, p-value = 1.585e-05
## alternative hypothesis: true location shift is not equal to 0
#p-value = 1.585e-05, statistically significant. 

#Plot
x<-(control_subset$leaf_average_)
y<-(Bacillus_paramycoides.data$leaf_average_)

data <- data.frame(
  Group = rep(c("Control", "Bacillus_paramycoides"), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() 
  labs(title = "Bacillus_paramycoides VS Control Leaf Length",
       x = "Group",
       y = "Leaf leangth Length mm") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Bacillus_paramycoides" = "lightgreen"))
## NULL
p


"Bacillus proteolyti"
## [1] "Bacillus proteolyti"
Bacillus_proteolyti.data <- subset(Data, species == "Bacillus_proteolyti")
summary(Bacillus_proteolyti.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##                                                                              
##    species           species_ID         root_length_   log_root_length   
##  Length:54          Length:54          Min.   :10.29   Length:54         
##  Class :character   Class :character   1st Qu.:19.15   Class :character  
##  Mode  :character   Mode  :character   Median :24.42   Mode  :character  
##                                        Mean   :24.75                     
##                                        3rd Qu.:29.24                     
##                                        Max.   :45.16                     
##                                                                          
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.535   Min.   :0.5485   Min.   :4.000   Min.   : 1.00  
##  1st Qu.:4.322   1st Qu.:0.6357   1st Qu.:4.000   1st Qu.: 3.00  
##  Median :4.793   Median :0.6806   Median :5.500   Median : 4.00  
##  Mean   :4.979   Mean   :0.6901   Mean   :5.056   Mean   : 4.66  
##  3rd Qu.:5.603   3rd Qu.:0.7484   3rd Qu.:6.000   3rd Qu.: 6.00  
##  Max.   :7.136   Max.   :0.8534   Max.   :6.000   Max.   :17.00  
##                                                   NA's   :1      
##   stem_length       log_stem     
##  Min.   :2.010   Min.   :0.3032  
##  1st Qu.:2.516   1st Qu.:0.4007  
##  Median :2.803   Median :0.4476  
##  Mean   :2.952   Mean   :0.4609  
##  3rd Qu.:3.266   3rd Qu.:0.5139  
##  Max.   :5.777   Max.   :0.7617  
## 
ggqqplot(Bacillus_proteolyti.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Bacillus_proteolyti.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Bacillus_proteolyti.data$log_leaf_avg
## W = 0.96844, p-value = 0.1645
#p-value = 0.1645, furfills normality assumtions 


anova_result <- aov(log_leaf_avg ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Bacillus_proteolyti.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.00314 0.00314               
## 
## Error: trial:plate
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.02433 0.02433               
## 
## Error: Within
##            Df Sum Sq  Mean Sq F value Pr(>F)  
## species     1 0.0309 0.030923   5.973 0.0162 *
## Residuals 104 0.5385 0.005178                 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# p-value=0.0162, suggesting statistically significant. 

#Plot
x<-(control_subset$leaf_average)
y<-(Bacillus_proteolyti.data$leaf_average)

data <- data.frame(
  Group = rep(c("Control", "Bacillus_proteolyti"), each = length(x)),
  Value = c(x, y)
)

# Boxplot 
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Bacillus_proteolyti VS Control Leaf length Average",
       x = "Group",
       y = "Leaf Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Bacillus_proteolyti" = "lightgreen"))


p


"Bacillus thuringiensis"
## [1] "Bacillus thuringiensis"
Bacillus_thuringiensis.data <- subset(Data, species == "Bacillus_thuringiensis")
summary(Bacillus_thuringiensis.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length   
##  Length:54          Length:54          Min.   :12.55   Length:54         
##  Class :character   Class :character   1st Qu.:19.62   Class :character  
##  Mode  :character   Mode  :character   Median :26.49   Mode  :character  
##                                        Mean   :28.45                     
##                                        3rd Qu.:36.23                     
##                                        Max.   :52.01                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :4.254   Min.   :0.6288   Min.   :4.000   Min.   :2.000  
##  1st Qu.:5.048   1st Qu.:0.7031   1st Qu.:6.000   1st Qu.:4.000  
##  Median :5.463   Median :0.7374   Median :6.000   Median :5.000  
##  Mean   :5.694   Mean   :0.7504   Mean   :5.944   Mean   :5.407  
##  3rd Qu.:6.128   3rd Qu.:0.7873   3rd Qu.:6.000   3rd Qu.:7.750  
##  Max.   :8.762   Max.   :0.9426   Max.   :8.000   Max.   :9.000  
##   stem_length       log_stem      
##  Min.   :1.255   Min.   :0.09864  
##  1st Qu.:2.221   1st Qu.:0.34654  
##  Median :2.516   Median :0.40071  
##  Mean   :2.613   Mean   :0.40581  
##  3rd Qu.:3.065   3rd Qu.:0.48643  
##  Max.   :4.109   Max.   :0.61374
ggqqplot(Bacillus_thuringiensis.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Bacillus_thuringiensis.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Bacillus_thuringiensis.data$log_leaf_avg
## W = 0.95213, p-value = 0.03083
#p-value = 0.03083,does not furfill normality assumtions 

# Perform the Wilcoxon Rank Sum Test
wilcox_test <- wilcox.test(log_leaf_avg ~ species, data = rbind(control_subset, Bacillus_thuringiensis.data))
print(wilcox_test)
## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  log_leaf_avg by species
## W = 2425, p-value = 2.874e-09
## alternative hypothesis: true location shift is not equal to 0
#p-value = 2.874e-09, suggesting significantly different. 

#Plot
x<-(control_subset$leaf_average)
y<-(Bacillus_thuringiensis.data$leaf_average)

data <- data.frame(
  Group = rep(c("Control", "Bacillus_thuringiensis"), each = length(x)),
  Value = c(x, y)
)

# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
 labs(title = "Bacillus_thuringiensis VS Control Leaf Length Average",
       x = "Group",
       y = "Leaf Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Bacillus_thuringiensis" = "lightgreen"))

p 


Micobacterium_sp.data <- subset(Data, species == "Micobacterium_sp")
summary(Micobacterium_sp.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##                                                                              
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 9.051   Length:54         
##  Class :character   Class :character   1st Qu.:14.818   Class :character  
##  Mode  :character   Mode  :character   Median :17.951   Mode  :character  
##                                        Mean   :19.817                     
##                                        3rd Qu.:23.566                     
##                                        Max.   :45.558                     
##                                                                           
##  leaf_average_    log_leaf_avg      leaf_count   lateral_roots  
##  Min.   :3.166   Min.   :0.5005   Min.   :4.00   Min.   :3.000  
##  1st Qu.:3.942   1st Qu.:0.5958   1st Qu.:6.00   1st Qu.:4.250  
##  Median :4.580   Median :0.6609   Median :6.00   Median :5.500  
##  Mean   :4.599   Mean   :0.6559   Mean   :5.83   Mean   :5.519  
##  3rd Qu.:5.079   3rd Qu.:0.7058   3rd Qu.:6.00   3rd Qu.:6.000  
##  Max.   :6.821   Max.   :0.8338   Max.   :6.00   Max.   :9.000  
##                                   NA's   :1                     
##   stem_length       log_stem     
##  Min.   :1.396   Min.   :0.1449  
##  1st Qu.:2.049   1st Qu.:0.3114  
##  Median :2.394   Median :0.3792  
##  Mean   :2.465   Mean   :0.3818  
##  3rd Qu.:2.708   3rd Qu.:0.4326  
##  Max.   :3.739   Max.   :0.5728  
## 
ggqqplot(Micobacterium_sp.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Micobacterium_sp.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Micobacterium_sp.data$log_leaf_avg
## W = 0.98159, p-value = 0.5708
#p-value = 0.5708,furfills normality assumtions 


anova_result <- aov(log_leaf_avg ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Micobacterium_sp.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.005415 0.005415               
## 
## Error: trial:plate
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 2.29e-05 2.29e-05               
## 
## Error: Within
##            Df Sum Sq  Mean Sq F value Pr(>F)
## species     1 0.0000 0.000004   0.001  0.978
## Residuals 104 0.5509 0.005297
#p-value=0.978, not statistically significant.
"Microbacterium_oxydans"
## [1] "Microbacterium_oxydans"
Microbacterium_oxydans.data <- subset(Data, species == "Microbacterium_oxydans")
summary(Microbacterium_oxydans.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 2.518   Length:54         
##  Class :character   Class :character   1st Qu.:12.134   Class :character  
##  Mode  :character   Mode  :character   Median :19.643   Mode  :character  
##                                        Mean   :21.879                     
##                                        3rd Qu.:29.620                     
##                                        Max.   :56.961                     
##  leaf_average_    log_leaf_avg      leaf_count     lateral_roots   
##  Min.   :3.574   Min.   :0.5531   Min.   : 4.000   Min.   : 0.000  
##  1st Qu.:4.504   1st Qu.:0.6535   1st Qu.: 4.000   1st Qu.: 3.250  
##  Median :4.878   Median :0.6882   Median : 5.000   Median : 5.000  
##  Mean   :5.136   Mean   :0.7052   Mean   : 5.926   Mean   : 5.407  
##  3rd Qu.:5.774   3rd Qu.:0.7615   3rd Qu.: 6.000   3rd Qu.: 6.000  
##  Max.   :7.236   Max.   :0.8595   Max.   :55.000   Max.   :65.000  
##   stem_length       log_stem     
##  Min.   :1.689   Min.   :0.2276  
##  1st Qu.:2.653   1st Qu.:0.4237  
##  Median :3.220   Median :0.5078  
##  Mean   :3.224   Mean   :0.4980  
##  3rd Qu.:3.720   3rd Qu.:0.5705  
##  Max.   :4.986   Max.   :0.6978
ggqqplot(Microbacterium_oxydans.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Microbacterium_oxydans.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Microbacterium_oxydans.data$log_leaf_avg
## W = 0.9854, p-value = 0.7504
#p-value = 0.7504 furfills normality assumtions 


anova_result <- aov(log_leaf_avg ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Microbacterium_oxydans.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.004351 0.004351               
## 
## Error: trial:plate
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.01094 0.01094               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value  Pr(>F)    
## species     1 0.0646 0.06463   14.14 0.00028 ***
## Residuals 104 0.4753 0.00457                    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value =0.00028, suggesting significantly different 


#Plot
x<-(control_subset$leaf_average)
y<-(Microbacterium_oxydans.data$leaf_average)

data <- data.frame(
  Group = rep(c("Control", "Microbacterium_oxydans"), each = length(x)),
  Value = c(x, y)
)

# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Microbacterium_oxydans VS Control Leaf Length",
       x = "Group",
       y = "Leaf Length mm") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Microbacterium_oxydans" = "lightgreen"))

p 


"Paenibacillus_sp."
## [1] "Paenibacillus_sp."
Paenibacillus_sp.data <- subset(Data, species == "Paenibacillus_sp")
summary(Paenibacillus_sp.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length   
##  Length:54          Length:54          Min.   :11.91   Length:54         
##  Class :character   Class :character   1st Qu.:19.66   Class :character  
##  Mode  :character   Mode  :character   Median :24.38   Mode  :character  
##                                        Mean   :24.35                     
##                                        3rd Qu.:27.73                     
##                                        Max.   :41.75                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :2.244   Min.   :0.3511   Min.   :4.000   Min.   :2.000  
##  1st Qu.:4.978   1st Qu.:0.6970   1st Qu.:4.000   1st Qu.:4.000  
##  Median :5.403   Median :0.7327   Median :4.000   Median :5.000  
##  Mean   :5.339   Mean   :0.7204   Mean   :4.926   Mean   :5.019  
##  3rd Qu.:5.808   3rd Qu.:0.7640   3rd Qu.:6.000   3rd Qu.:6.000  
##  Max.   :7.251   Max.   :0.8604   Max.   :6.000   Max.   :9.000  
##   stem_length       log_stem     
##  Min.   :1.545   Min.   :0.1889  
##  1st Qu.:2.329   1st Qu.:0.3672  
##  Median :2.651   Median :0.4235  
##  Mean   :2.790   Mean   :0.4338  
##  3rd Qu.:3.162   3rd Qu.:0.5000  
##  Max.   :4.483   Max.   :0.6516
ggqqplot(Paenibacillus_sp.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Paenibacillus_sp.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Paenibacillus_sp.data$log_leaf_avg
## W = 0.86936, p-value = 2.915e-05
#p-value = 2.915e-05, does not furfill normality assumtions 

wilcox_test <- wilcox.test(log_leaf_avg ~ species, data = rbind(control_subset, Paenibacillus_sp.data))
print(wilcox_test)
## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  log_leaf_avg by species
## W = 718.5, p-value = 5.605e-06
## alternative hypothesis: true location shift is not equal to 0
#p-value = 5.605e-06, suggesting significantly different. 

#Plot
x<-(control_subset$leaf_average)
y<-(Paenibacillus_sp.data$leaf_average)

data <- data.frame(
  Group = rep(c("Control", "Paenibacillus_sp"), each = length(x)),
  Value = c(x, y)
)

# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Paenibacillus_sp VS Control Leaf Length",
       x = "Group",
       y = "Leaf Length mm") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Paenibacillus_sp" = "lightgreen"))

p 


"Alternaria_alternata"
## [1] "Alternaria_alternata"
Alternaria_alternata.data <- subset(Data, species == "Alternaria_alternata")
summary(Alternaria_alternata.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 7.944   Length:54         
##  Class :character   Class :character   1st Qu.:18.028   Class :character  
##  Mode  :character   Mode  :character   Median :20.572   Mode  :character  
##                                        Mean   :22.258                     
##                                        3rd Qu.:26.841                     
##                                        Max.   :38.574                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :2.759   Min.   :0.4408   Min.   :4.000   Min.   :2.000  
##  1st Qu.:4.460   1st Qu.:0.6493   1st Qu.:6.000   1st Qu.:3.000  
##  Median :5.208   Median :0.7167   Median :6.000   Median :4.000  
##  Mean   :5.583   Mean   :0.7329   Mean   :5.907   Mean   :4.167  
##  3rd Qu.:6.651   3rd Qu.:0.8229   3rd Qu.:6.000   3rd Qu.:5.750  
##  Max.   :8.947   Max.   :0.9517   Max.   :8.000   Max.   :7.000  
##   stem_length       log_stem     
##  Min.   :1.445   Min.   :0.1599  
##  1st Qu.:1.940   1st Qu.:0.2877  
##  Median :2.212   Median :0.3447  
##  Mean   :2.352   Mean   :0.3596  
##  3rd Qu.:2.637   3rd Qu.:0.4211  
##  Max.   :4.179   Max.   :0.6211
ggqqplot(Alternaria_alternata.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Alternaria_alternata.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Alternaria_alternata.data$log_leaf_avg
## W = 0.97325, p-value = 0.267
#p-value = 0.267, fulfills normality assumptions 


anova_result <- aov(log_leaf_avg ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Alternaria_alternata.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.001736 0.001736               
## 
## Error: trial:plate
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.02725 0.02725               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1 0.1586  0.1586   19.12 2.93e-05 ***
## Residuals 104 0.8630  0.0083                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# p-value= 2.93e-05, significantly different. 

#Plot
x<-(control_subset$leaf_average)
y<-(Alternaria_alternata.data$leaf_average)

data <- data.frame(
  Group = rep(c("Control", "Alternaria_alternata"), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Alternaria_alternata VS Control Leaf Length",
       x = "Group",
       y = "Leaf Length mm") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Alternaria_alternata" = "lightgreen"))

p 


"Cladosporium_sp."
## [1] "Cladosporium_sp."
Cladosporium_sp.data <- subset(Data, species == "Cladosporium_sp.")
summary(Cladosporium_sp.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 4.253   Length:54         
##  Class :character   Class :character   1st Qu.:11.737   Class :character  
##  Mode  :character   Mode  :character   Median :15.358   Mode  :character  
##                                        Mean   :15.841                     
##                                        3rd Qu.:19.161                     
##                                        Max.   :29.520                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.115   Min.   :0.4935   Min.   :4.000   Min.   :2.000  
##  1st Qu.:4.125   1st Qu.:0.6154   1st Qu.:4.000   1st Qu.:2.000  
##  Median :4.651   Median :0.6675   Median :4.000   Median :2.000  
##  Mean   :4.675   Mean   :0.6628   Mean   :4.704   Mean   :2.815  
##  3rd Qu.:5.243   3rd Qu.:0.7195   3rd Qu.:6.000   3rd Qu.:4.000  
##  Max.   :6.526   Max.   :0.8146   Max.   :6.000   Max.   :6.000  
##   stem_length       log_stem      
##  Min.   :0.317   Min.   :-0.4989  
##  1st Qu.:2.243   1st Qu.: 0.3508  
##  Median :2.653   Median : 0.4237  
##  Mean   :2.670   Mean   : 0.4041  
##  3rd Qu.:3.075   3rd Qu.: 0.4879  
##  Max.   :5.808   Max.   : 0.7640
ggqqplot(Cladosporium_sp.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Cladosporium_sp.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Cladosporium_sp.data$log_leaf_avg
## W = 0.98579, p-value = 0.768
#p-value = 0.768, furfills normality assumtions 

anova_result <- aov(log_leaf_avg ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Cladosporium_sp.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##            Df   Sum Sq  Mean Sq
## soil_space  1 0.009201 0.009201
## 
## Error: trial:plate
##            Df    Sum Sq   Mean Sq
## soil_space  1 7.024e-07 7.024e-07
## 
## Error: Within
##             Df Sum Sq  Mean Sq F value Pr(>F)
## species      1 0.0011 0.001135   0.209  0.648
## soil_space   1 0.0004 0.000421   0.078  0.781
## Residuals  103 0.5582 0.005420
#Not significantly different 
"Didymella_americana"
## [1] "Didymella_americana"
Didymella_americana.data <- subset(Data, species == "Didymella_americana")
summary(Didymella_americana.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 9.054   Length:54         
##  Class :character   Class :character   1st Qu.:18.033   Class :character  
##  Mode  :character   Mode  :character   Median :28.211   Mode  :character  
##                                        Mean   :30.541                     
##                                        3rd Qu.:39.836                     
##                                        Max.   :65.382                     
##  leaf_average_     log_leaf_avg      leaf_count    lateral_roots   
##  Min.   : 2.901   Min.   :0.4625   Min.   :4.000   Min.   : 2.000  
##  1st Qu.: 4.807   1st Qu.:0.6819   1st Qu.:5.250   1st Qu.: 5.250  
##  Median : 7.732   Median :0.8883   Median :6.000   Median : 8.000  
##  Mean   : 7.334   Mean   :0.8382   Mean   :5.648   Mean   : 9.093  
##  3rd Qu.: 9.031   3rd Qu.:0.9556   3rd Qu.:6.000   3rd Qu.:10.000  
##  Max.   :13.024   Max.   :1.1147   Max.   :6.000   Max.   :67.000  
##   stem_length       log_stem     
##  Min.   :1.416   Min.   :0.1511  
##  1st Qu.:1.978   1st Qu.:0.2961  
##  Median :2.292   Median :0.3601  
##  Mean   :2.347   Mean   :0.3601  
##  3rd Qu.:2.696   3rd Qu.:0.4308  
##  Max.   :3.631   Max.   :0.5600
ggqqplot(Didymella_americana.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Didymella_americana.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Didymella_americana.data$log_leaf_avg
## W = 0.9487, p-value = 0.02184
#p-value = 0.02184, does not furfill normality assumtions 

wilcox_test <- wilcox.test(log_leaf_avg ~ species, data = rbind(control_subset, Didymella_americana.data))
print(wilcox_test)
## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  log_leaf_avg by species
## W = 512.5, p-value = 6.378e-09
## alternative hypothesis: true location shift is not equal to 0
#p-value = 6.378e-09

#Plot
x<-(control_subset$leaf_average)
y<-(Didymella_americana.data$leaf_average)

data <- data.frame(
  Group = rep(c("Control", "Didymella_americana"), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Didymella_americana VS COntrol Leaf Length",
       x = "Group",
       y = "Leaf Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Didymella_americana" = "lightgreen"))


p 


"Filobasidium_floriflorm"
## [1] "Filobasidium_floriflorm"
Filobasidium_floriflorm.data <- subset(Data, species == "Filobasidium_floriflorm")
summary(Filobasidium_floriflorm.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length   
##  Length:54          Length:54          Min.   :11.80   Length:54         
##  Class :character   Class :character   1st Qu.:20.27   Class :character  
##  Mode  :character   Mode  :character   Median :24.02   Mode  :character  
##                                        Mean   :25.40                     
##                                        3rd Qu.:31.32                     
##                                        Max.   :44.20                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots   
##  Min.   :3.571   Min.   :0.5527   Min.   :4.000   Min.   : 0.000  
##  1st Qu.:4.410   1st Qu.:0.6444   1st Qu.:5.000   1st Qu.: 6.000  
##  Median :4.827   Median :0.6837   Median :6.000   Median : 8.000  
##  Mean   :4.861   Mean   :0.6821   Mean   :5.444   Mean   : 8.241  
##  3rd Qu.:5.309   3rd Qu.:0.7250   3rd Qu.:6.000   3rd Qu.:10.750  
##  Max.   :7.411   Max.   :0.8699   Max.   :7.000   Max.   :17.000  
##   stem_length       log_stem     
##  Min.   :1.306   Min.   :0.1159  
##  1st Qu.:2.049   1st Qu.:0.3116  
##  Median :2.381   Median :0.3767  
##  Mean   :2.404   Mean   :0.3698  
##  3rd Qu.:2.646   3rd Qu.:0.4226  
##  Max.   :3.670   Max.   :0.5647
ggqqplot(Filobasidium_floriflorm.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Filobasidium_floriflorm.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Filobasidium_floriflorm.data$log_leaf_avg
## W = 0.97781, p-value = 0.4122
#p-value = 0.4122 furfills normality assumtions 

anova_result <- aov(log_leaf_avg ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Filobasidium_floriflorm.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.001849 0.001849               
## 
## Error: trial:plate
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.00866 0.00866               
## 
## Error: Within
##            Df Sum Sq  Mean Sq F value Pr(>F)  
## species     1 0.0180 0.017970   4.201 0.0429 *
## Residuals 104 0.4449 0.004278                 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value=0.0429, significantly different

#Plot
x<-(control_subset$leaf_average)
y<-(Filobasidium_floriflorm.data$leaf_average)

data <- data.frame(
  Group = rep(c("Control", "Filobasidium_floriflorm"), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Filobasidium_floriflorm VS COntrol Stem length",
       x = "Group",
       y = "Stem Length") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Filobasidium_floriflorm" = "lightgreen"))

p 


"Fusarium_equiseti"
## [1] "Fusarium_equiseti"
Fusarium_equiseti.data <- subset(Data, species == "Fusarium_equiseti")
summary(Fusarium_equiseti.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 7.576   Length:54         
##  Class :character   Class :character   1st Qu.:12.081   Class :character  
##  Mode  :character   Mode  :character   Median :14.280   Mode  :character  
##                                        Mean   :15.041                     
##                                        3rd Qu.:17.196                     
##                                        Max.   :25.450                     
##  leaf_average_    log_leaf_avg      leaf_count   lateral_roots  stem_length   
##  Min.   :1.928   Min.   :0.2851   Min.   :4.00   Min.   : 2    Min.   :0.888  
##  1st Qu.:2.873   1st Qu.:0.4583   1st Qu.:4.00   1st Qu.: 4    1st Qu.:1.627  
##  Median :3.449   Median :0.5377   Median :5.00   Median : 6    Median :1.855  
##  Mean   :3.553   Mean   :0.5366   Mean   :4.87   Mean   : 7    Mean   :1.848  
##  3rd Qu.:4.201   3rd Qu.:0.6233   3rd Qu.:6.00   3rd Qu.: 9    3rd Qu.:2.109  
##  Max.   :6.246   Max.   :0.7956   Max.   :6.00   Max.   :16    Max.   :3.299  
##     log_stem       
##  Min.   :-0.05159  
##  1st Qu.: 0.21139  
##  Median : 0.26833  
##  Mean   : 0.25393  
##  3rd Qu.: 0.32408  
##  Max.   : 0.51838
summary(control_subset)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 8.128   Length:54         
##  Class :character   Class :character   1st Qu.:13.794   Class :character  
##  Mode  :character   Mode  :character   Median :17.407   Mode  :character  
##                                        Mean   :18.637                     
##                                        3rd Qu.:21.004                     
##                                        Max.   :34.876                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots   
##  Min.   :3.462   Min.   :0.5393   Min.   :4.000   Min.   : 2.000  
##  1st Qu.:3.988   1st Qu.:0.6008   1st Qu.:4.000   1st Qu.: 5.000  
##  Median :4.497   Median :0.6529   Median :6.000   Median : 7.000  
##  Mean   :4.586   Mean   :0.6563   Mean   :5.222   Mean   : 7.093  
##  3rd Qu.:5.244   3rd Qu.:0.7197   3rd Qu.:6.000   3rd Qu.: 9.000  
##  Max.   :5.962   Max.   :0.7754   Max.   :6.000   Max.   :15.000  
##   stem_length       log_stem       
##  Min.   :1.005   Min.   :0.002166  
##  1st Qu.:1.842   1st Qu.:0.265289  
##  Median :2.119   Median :0.326130  
##  Mean   :2.162   Mean   :0.323987  
##  3rd Qu.:2.419   3rd Qu.:0.383591  
##  Max.   :3.368   Max.   :0.527372
ggqqplot(Fusarium_equiseti.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Fusarium_equiseti.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Fusarium_equiseti.data$log_leaf_avg
## W = 0.99284, p-value = 0.9862
#  p-value = 0.9862, does furfill normality assumtions.

anova_result <- aov(log_leaf_avg ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Fusarium_equiseti.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.01655 0.01655               
## 
## Error: trial:plate
##           Df    Sum Sq   Mean Sq F value Pr(>F)
## Residuals  1 0.0001978 0.0001978               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1 0.3869  0.3869   45.41 9.13e-10 ***
## Residuals 104 0.8861  0.0085                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value= 9.13e-10, significantly different

#Plot
data <- data.frame(
  Group = rep(c("Control", "Fusarium_equiseti"), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Fusarium_equiseti VS Control Leaf length",
       x = "Group",
       y = "Leaf Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        legend.title = element_text(size = 10),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue","Fusarium_equiseti" = "lightgreen"))


p 


'Naganishia_albidus'
## [1] "Naganishia_albidus"
Naganishia_albidus.data <- subset(Data, species == "Naganishia_albidus")
summary(Naganishia_albidus.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 9.227   Length:54         
##  Class :character   Class :character   1st Qu.:18.879   Class :character  
##  Mode  :character   Mode  :character   Median :28.444   Mode  :character  
##                                        Mean   :28.930                     
##                                        3rd Qu.:38.758                     
##                                        Max.   :53.584                     
##  leaf_average_    log_leaf_avg      leaf_count   lateral_roots   
##  Min.   :3.183   Min.   :0.5028   Min.   :4.00   Min.   : 2.000  
##  1st Qu.:4.381   1st Qu.:0.6416   1st Qu.:6.00   1st Qu.: 4.000  
##  Median :4.812   Median :0.6823   Median :6.00   Median : 6.000  
##  Mean   :5.109   Mean   :0.6988   Mean   :5.87   Mean   : 7.148  
##  3rd Qu.:5.936   3rd Qu.:0.7735   3rd Qu.:6.00   3rd Qu.: 8.000  
##  Max.   :8.018   Max.   :0.9040   Max.   :7.00   Max.   :17.000  
##   stem_length       log_stem     
##  Min.   :1.584   Min.   :0.1998  
##  1st Qu.:2.165   1st Qu.:0.3355  
##  Median :2.438   Median :0.3871  
##  Mean   :2.521   Mean   :0.3920  
##  3rd Qu.:2.847   3rd Qu.:0.4544  
##  Max.   :3.891   Max.   :0.5901
ggqqplot(Naganishia_albidus.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Naganishia_albidus.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Naganishia_albidus.data$log_leaf_avg
## W = 0.98377, p-value = 0.6732
# p-value=0.6732, furfills normality assumtions 

anova_result <- aov(log_leaf_avg ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Naganishia_albidus.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.02322 0.02322               
## 
## Error: trial:plate
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.004276 0.004276               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value  Pr(>F)   
## species     1 0.0489 0.04892   7.742 0.00641 **
## Residuals 104 0.6571 0.00632                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# p-value=0.00641

#Plot
x<-(control_subset$leaf_average)
y<-(Naganishia_albidus.data$leaf_average)

data <- data.frame(
  Group = rep(c("Control", "Naganishia_albidus"), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Naganishia_albidus VS Control Leaf length",
       x = "Group",
       y = "Leaf Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Naganishia_albidus" = "lightgreen"))

p 


"Subramaniula_cuniculorum"
## [1] "Subramaniula_cuniculorum"
Subramaniula_cuniculorum.data <- subset(Data, species == "Subramaniula_c.")
summary(Subramaniula_cuniculorum.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length   
##  Length:54          Length:54          Min.   :12.73   Length:54         
##  Class :character   Class :character   1st Qu.:21.33   Class :character  
##  Mode  :character   Mode  :character   Median :25.57   Mode  :character  
##                                        Mean   :25.93                     
##                                        3rd Qu.:29.10                     
##                                        Max.   :42.50                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.780   Min.   :0.5774   Min.   :4.000   Min.   :0.000  
##  1st Qu.:4.540   1st Qu.:0.6571   1st Qu.:5.000   1st Qu.:2.000  
##  Median :5.136   Median :0.7106   Median :6.000   Median :3.000  
##  Mean   :5.542   Mean   :0.7313   Mean   :5.426   Mean   :3.204  
##  3rd Qu.:6.120   3rd Qu.:0.7867   3rd Qu.:6.000   3rd Qu.:4.000  
##  Max.   :9.502   Max.   :0.9778   Max.   :6.000   Max.   :8.000  
##   stem_length       log_stem       
##  Min.   :1.006   Min.   :0.002598  
##  1st Qu.:1.919   1st Qu.:0.283010  
##  Median :2.437   Median :0.386746  
##  Mean   :2.572   Mean   :0.380294  
##  3rd Qu.:3.039   3rd Qu.:0.482802  
##  Max.   :7.868   Max.   :0.895864
ggqqplot(Subramaniula_cuniculorum.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Subramaniula_cuniculorum.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Subramaniula_cuniculorum.data$log_leaf_avg
## W = 0.9347, p-value = 0.005639
# p-value = 0.005639 does not furfill normality assumtions 


x<-(control_subset$leaf_average)
y<-(Subramaniula_cuniculorum.data$leaf_average)
wilcox.test(x, y) 
## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  x and y
## W = 843, p-value = 0.0001595
## alternative hypothesis: true location shift is not equal to 0
##p-value = 0.0001595

#Plot
data <- data.frame(
  Group = rep(c("Control", "Subramaniula_cuniculorum"), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Subramaniula_cuniculorum VS Control Leaf length",
       x = "Group",
       y = "Leaf Length") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Subramaniula_cuniculorum" = "lightgreen"))

p 


"Westerdykella_centenaria"
## [1] "Westerdykella_centenaria"
Westerdykella_centenaria.data <- subset(Data, species == "Westerdykella_centenaria")
summary(Westerdykella_centenaria.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length   
##  Length:54          Length:54          Min.   : 0.00   Length:54         
##  Class :character   Class :character   1st Qu.:12.57   Class :character  
##  Mode  :character   Mode  :character   Median :18.32   Mode  :character  
##                                        Mean   :20.26                     
##                                        3rd Qu.:25.97                     
##                                        Max.   :45.79                     
##  leaf_average_     log_leaf_avg      leaf_count    lateral_roots   
##  Min.   : 2.412   Min.   :0.3824   Min.   :4.000   Min.   : 2.000  
##  1st Qu.: 4.170   1st Qu.:0.6202   1st Qu.:6.000   1st Qu.: 4.250  
##  Median : 4.947   Median :0.6943   Median :6.000   Median : 7.000  
##  Mean   : 5.065   Mean   :0.6846   Mean   :5.611   Mean   : 6.944  
##  3rd Qu.: 5.450   3rd Qu.:0.7364   3rd Qu.:6.000   3rd Qu.: 8.750  
##  Max.   :10.015   Max.   :1.0007   Max.   :6.000   Max.   :15.000  
##   stem_length       log_stem     
##  Min.   :1.363   Min.   :0.1345  
##  1st Qu.:1.840   1st Qu.:0.2648  
##  Median :2.134   Median :0.3292  
##  Mean   :2.120   Mean   :0.3194  
##  3rd Qu.:2.374   3rd Qu.:0.3754  
##  Max.   :3.179   Max.   :0.5023
ggqqplot(Westerdykella_centenaria.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Westerdykella_centenaria.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Westerdykella_centenaria.data$log_leaf_avg
## W = 0.97134, p-value = 0.2207
# p-value = 0.2207,furfills normality assumtions 

anova_result <- aov(log_leaf_avg ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Westerdykella_centenaria.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.03219 0.03219               
## 
## Error: trial:plate
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.02951 0.02951               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value Pr(>F)
## species     1 0.0216 0.02161   2.022  0.158
## Residuals 104 1.1119 0.01069
#p-value= 0.158, not significant difference 
"Phoma sp. 301"
## [1] "Phoma sp. 301"
Phoma_sp301.data <- subset(Data, species_ID == "301ci57")
summary(Phoma_sp301.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length   
##  Length:54          Length:54          Min.   :10.83   Length:54         
##  Class :character   Class :character   1st Qu.:19.00   Class :character  
##  Mode  :character   Mode  :character   Median :24.94   Mode  :character  
##                                        Mean   :25.08                     
##                                        3rd Qu.:30.72                     
##                                        Max.   :46.63                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots   
##  Min.   :3.318   Min.   :0.5209   Min.   :4.000   Min.   :  3.00  
##  1st Qu.:4.766   1st Qu.:0.6782   1st Qu.:5.000   1st Qu.:  6.00  
##  Median :5.738   Median :0.7587   Median :6.000   Median :  8.00  
##  Mean   :5.879   Mean   :0.7547   Mean   :5.667   Mean   : 22.83  
##  3rd Qu.:6.823   3rd Qu.:0.8340   3rd Qu.:6.000   3rd Qu.:  9.00  
##  Max.   :9.755   Max.   :0.9892   Max.   :7.000   Max.   :812.00  
##   stem_length       log_stem      
##  Min.   :1.077   Min.   :0.03222  
##  1st Qu.:1.657   1st Qu.:0.21942  
##  Median :1.895   Median :0.27772  
##  Mean   :1.965   Mean   :0.27984  
##  3rd Qu.:2.192   3rd Qu.:0.34079  
##  Max.   :3.306   Max.   :0.51930
ggqqplot(Phoma_sp301.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Phoma_sp301.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Phoma_sp301.data$log_leaf_avg
## W = 0.98072, p-value = 0.5315
#furfills normality assumtions 

anova_result <- aov(log_leaf_avg ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Phoma_sp301.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.1209  0.1209               
## 
## Error: trial:plate
##           Df    Sum Sq   Mean Sq F value Pr(>F)
## Residuals  1 6.812e-05 6.812e-05               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1 0.2613 0.26126   33.74 6.93e-08 ***
## Residuals 104 0.8053 0.00774                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# p-value= 6.93e-08 ***, significantly different.




#Plot
x<-(control_subset$leaf_average)
y<-(Phoma_sp301.data$leaf_average)

data <- data.frame(
  Group = rep(c("Control", "Phoma_sp301.data"), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Phoma VS Control Leaf length",
       x = "Group",
       y = "Leaf Length") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Phoma_sp301" = "lightgreen"))


p 


"Phoma sp._313"
## [1] "Phoma sp._313"
Phoma_sp313.data <- subset(Data, species_ID == "313dri103")
summary(Phoma_sp313.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 7.576   Length:54         
##  Class :character   Class :character   1st Qu.:12.081   Class :character  
##  Mode  :character   Mode  :character   Median :14.280   Mode  :character  
##                                        Mean   :15.041                     
##                                        3rd Qu.:17.196                     
##                                        Max.   :25.450                     
##  leaf_average_    log_leaf_avg      leaf_count   lateral_roots  
##  Min.   :1.953   Min.   :0.2907   Min.   :4.00   Min.   :0.000  
##  1st Qu.:2.710   1st Qu.:0.4330   1st Qu.:4.00   1st Qu.:1.000  
##  Median :3.011   Median :0.4787   Median :6.00   Median :2.000  
##  Mean   :3.155   Mean   :0.4893   Mean   :5.37   Mean   :2.056  
##  3rd Qu.:3.452   3rd Qu.:0.5381   3rd Qu.:6.00   3rd Qu.:3.000  
##  Max.   :5.596   Max.   :0.7478   Max.   :7.00   Max.   :7.000  
##   stem_length        log_stem       
##  Min.   :0.6870   Min.   :-0.16304  
##  1st Qu.:0.9597   1st Qu.:-0.01794  
##  Median :1.2395   Median : 0.09324  
##  Mean   :1.3721   Mean   : 0.10114  
##  3rd Qu.:1.4500   3rd Qu.: 0.16136  
##  Max.   :4.8870   Max.   : 0.68904
ggqqplot(Phoma_sp313.data$log_leaf_avg) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Phoma_sp313.data$log_leaf_avg)
## 
##  Shapiro-Wilk normality test
## 
## data:  Phoma_sp313.data$log_leaf_avg
## W = 0.97619, p-value = 0.3547
#P-value= p-value = 0.3547. Does furfill normality assumtions 

anova_result <- aov(log_leaf_avg ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Phoma_sp313.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.01277 0.01277               
## 
## Error: trial:plate
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 2.03e-05 2.03e-05               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value Pr(>F)    
## species     1 0.7525  0.7525   117.9 <2e-16 ***
## Residuals 104 0.6636  0.0064                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value= 117.9 <2e-16, significantly different

#Plot
x<-(control_subset$leaf_average)
y<-(Phoma_sp313.data $leaf_average)


data <- data.frame(
  Group = rep(c("Control", "Phoma sp."), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Phoma sp. VS Control Stem Length",
       x = "Group",
       y = "Stem Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        axis.title.x = element_text(size = 10),
        axis.title.y = element_text(size = 10),
        legend.title = element_text(size = 10),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Phoma sp.313" = "lightgreen"))


p  


# Sample data structure
# data <- data.frame(
#   species = rep(c("Species1", "Species2", "Species3"), each = 10),
#   leaf_length = rnorm(30, mean = 5, sd = 2),
#   group = rep(c("Control", "Test"), each = 15),
#   type_of_microbe = rep(c("Bacteria", "Fungi"), each = 15)
# )

# Load necessary libraries
library(dplyr)

# Generate summary statistics
summary_data <- Data %>%
  group_by(soil_space, species, microbe_) %>%
  summarise(
    mean_leaf_average = mean(leaf_average_),
    se_leaf_length = sd(leaf_average_) / sqrt(n()),
    .groups = 'drop'
  )

# Print the summary table
print(summary_data)
## # A tibble: 23 × 5
##    soil_space species                 microbe_ mean_leaf_average se_leaf_length
##    <chr>      <chr>                   <chr>                <dbl>          <dbl>
##  1 control    control                 control               4.59         0.0971
##  2 inter      Acidovorax_sp           bacteria              5.64         0.224 
##  3 inter      Alternaria_alternata    fungi                 5.58         0.197 
##  4 inter      Anuerinibacillus_sp     bacteria              4.53         0.118 
##  5 inter      Bacillus_mycodies       bacteria              4.72         0.0758
##  6 inter      Bacillus_proteolyti     bacteria              4.98         0.125 
##  7 inter      Cladosporium_sp.        fungi                 4.28        NA     
##  8 inter      Didymella_americana     fungi                 7.33         0.341 
##  9 inter      Filobasidium_floriflorm fungi                 4.86         0.0997
## 10 inter      Microbacterium_oxydans  bacteria              5.14         0.112 
## # ℹ 13 more rows
# Export the summary table to a CSV file
write.csv(summary_data, "summary_table.csv", row.names = FALSE)

###Confrontation trial stats Stem Length

#Uploading packages and Data set. 

Data<-read.csv("Rconfrontation_data.csv", header=T)
#Creating a subset for the control 
control_subset <- subset(Data, species == "control")
Bacteria species and Fungal species, first testing for normality and then doing ANOVA or WILCOXON (if normality is not met)

###Using Log transformed data for ANOVA analysis 

#control
library("ggpubr")
## Loading required package: ggplot2
ggqqplot(control_subset$log_stem ) #draws the correlation between a given sample and the normal distribution.


#p value needs to be higher than 0.05 to assume normality
shapiro.test(control_subset$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  control_subset$log_stem
## W = 0.97125, p-value = 0.2188
#p-value = 0.2188



##testing normality for each species and test the appropriate test, One way ANOVA for species that fulfill normality, and WILCOXON for species that do not fulfill normality. 
library(dplyr)
## 
## Attaching package: 'dplyr'
## The following objects are masked from 'package:stats':
## 
##     filter, lag
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
head(Data)
 
 
microbe_
<chr>
soil_space
<chr>
trial
<int>
plate
<int>
seed_replicate
<int>
species
<chr>
species_ID
<chr>
root_length_
<dbl>
1	fungi	inter	1	1	1	Phoma_sp.	301ci57	34.661	
2	fungi	inter	1	1	2	Phoma_sp.	301ci57	26.586	
3	fungi	inter	1	1	3	Phoma_sp.	301ci57	27.990	
4	fungi	inter	1	1	4	Phoma_sp.	301ci57	23.032	
5	fungi	inter	1	1	5	Phoma_sp.	301ci57	24.731	
6	fungi	inter	1	1	6	Phoma_sp.	301ci57	23.193	
6 rows | 1-9 of 16 columns
# Summary statistics for each species
summary_stats <- Data %>%
  group_by(species) %>%
  summarise(
    mean_length = mean(stem_length),
    sd_length = sd(stem_length),
    n = n()
  )

print(summary_stats)
## # A tibble: 22 × 4
##    species                mean_length sd_length     n
##    <chr>                        <dbl>     <dbl> <int>
##  1 Acidovorax_sp                 2.90     0.630    54
##  2 Alternaria_alternata          2.35     0.578    54
##  3 Anthrobacter_agilis           2.59     0.530    54
##  4 Anuerinibacillus_sp           2.73     0.435    54
##  5 Bacillus_cerus                2.57     0.532    54
##  6 Bacillus_mycodies             3.25     0.677    54
##  7 Bacillus_paramycoides         2.59     0.531    54
##  8 Bacillus_proteolyti           2.95     0.656    54
##  9 Bacillus_thuringiensis        2.61     0.595    54
## 10 Cladosporium_sp.              2.67     0.762    54
## # ℹ 12 more rows
# Facet grid plot for Stem Length across microbial species, faceted by type of microbe
ggplot(Data, aes(x = species, y = stem_length)) +
  geom_boxplot(aes(fill = species)) +
  facet_wrap(~microbe_) +
  theme_minimal() +
  labs(title = "Stem Length Across Microbial Species",
       x = "Microbial Species",
       y = "Stem Length (mm)")


##Need to spread out x axis for species names

# Boxplot to compare Stem Lengths with colors
ggplot(Data, aes(x = soil_space, y = stem_length, fill = soil_space)) +
  geom_boxplot() +
  theme_minimal() +
  labs(
    title ="Comparison of Stem Length Between Test Species and Control",
    x = "Soil Space",
    y = "Stem Length (mm)"
  ) +
  scale_fill_manual(values = c("inter" = "skyblue", "under" = "salmon", "control" = "purple"))+
  theme(
    plot.title = element_text(size = 10) )


# Boxplot to compare Stem Lengths with colors
ggplot(Data, aes(x = microbe_, y = stem_length, fill = microbe_)) +
  geom_boxplot() +
  theme_minimal() +
  labs(
    title ="Comparison of Stem Length Between Test Species and Control",
    x = "Microbe type",
    y = "Stem Length (mm)"
  ) +
  scale_fill_manual(values = c("inter" = "orange", "bacteria" = "pink", "fungi" = "brown"))+
  theme(
    plot.title = element_text(size = 10) )


# Perform ANOVA to compare means among soil space
anova_result <- aov(log_stem  ~ soil_space, data = Data)
summary(anova_result)
##               Df Sum Sq Mean Sq F value  Pr(>F)   
## soil_space     2   0.18 0.08980   5.006 0.00683 **
## Residuals   1239  22.22 0.01794                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#Conclusion:
#The ANOVA results show that the soil_space factor has a statistically significant effect on the log_stem  variable (p = 0.00683). This suggests that the means of log_stem  are significantly different across the levels of soil_space.


# If ANOVA is significant, perform post-hoc Tukey's HSD test
tukey_result <- TukeyHSD(anova_result)
print(tukey_result)
##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = log_stem ~ soil_space, data = Data)
## 
## $soil_space
##                      diff          lwr        upr     p adj
## inter-control 0.053241455  0.008730941 0.09775197 0.0140646
## under-control 0.060353490  0.015495454 0.10521153 0.0046465
## under-inter   0.007112035 -0.011202490 0.02542656 0.6332962
# Visualize Tukey's HSD test results
plot(tukey_result)


"Acidovorax_sp."
## [1] "Acidovorax_sp."
#Creating a Acidovorax_sp subset from data 
Acidovorax_sp.data <- subset(Data, species == "Acidovorax_sp")
summary(Acidovorax_sp.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 7.464   Length:54         
##  Class :character   Class :character   1st Qu.:14.636   Class :character  
##  Mode  :character   Mode  :character   Median :18.851   Mode  :character  
##                                        Mean   :19.611                     
##                                        3rd Qu.:24.459                     
##                                        Max.   :38.849                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.329   Min.   :0.5222   Min.   :4.000   Min.   :1.000  
##  1st Qu.:4.429   1st Qu.:0.6463   1st Qu.:4.250   1st Qu.:3.000  
##  Median :5.222   Median :0.7178   Median :6.000   Median :4.000  
##  Mean   :5.638   Mean   :0.7342   Mean   :5.519   Mean   :4.389  
##  3rd Qu.:6.857   3rd Qu.:0.8357   3rd Qu.:6.000   3rd Qu.:6.000  
##  Max.   :9.300   Max.   :0.9685   Max.   :8.000   Max.   :9.000  
##   stem_length       log_stem     
##  Min.   :1.583   Min.   :0.1995  
##  1st Qu.:2.503   1st Qu.:0.3985  
##  Median :2.904   Median :0.4630  
##  Mean   :2.902   Mean   :0.4526  
##  3rd Qu.:3.324   3rd Qu.:0.5217  
##  Max.   :4.916   Max.   :0.6916
ggqqplot(Acidovorax_sp.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(control_subset$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  control_subset$log_stem
## W = 0.97125, p-value = 0.2188
#p value needs to be higher than 0.05 to assume normality
#p-value =0.2188, fufrills normality assumtions

anova_result <- aov(log_stem  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Acidovorax_sp.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects

summary(anova_result)
## 
## Error: trial
##           Df    Sum Sq   Mean Sq F value Pr(>F)
## Residuals  1 7.642e-05 7.642e-05               
## 
## Error: trial:plate
##           Df    Sum Sq   Mean Sq F value Pr(>F)
## Residuals  1 0.0001456 0.0001456               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1 0.4463  0.4463   45.81 7.91e-10 ***
## Residuals 104 1.0132  0.0097                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#Pvalue is 7.91e-10,there is significant difference.


#Plot
x<-(control_subset$stem_length)
y<-(Acidovorax_sp.data$stem_length)

data <- data.frame(
  Group = rep(c("Control", "Acidovorax_sp"), each = length(x)),
  Value = c(x, y)
)
# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Acidovorax_sp VS Control Stem Length",
       x = "Group",
       y = "Stem Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Acidovorax_sp" = "lightgreen"))

p 


"Anthrobacter_agilis"
## [1] "Anthrobacter_agilis"
Anthrobacter_agilis.data <- subset(Data, species == "Anthrobacter_agilis")
summary(Anthrobacter_agilis.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length   
##  Length:54          Length:54          Min.   : 0.00   Length:54         
##  Class :character   Class :character   1st Qu.:11.50   Class :character  
##  Mode  :character   Mode  :character   Median :15.35   Mode  :character  
##                                        Mean   :17.66                     
##                                        3rd Qu.:22.93                     
##                                        Max.   :47.28                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.341   Min.   :0.5239   Min.   :4.000   Min.   :0.000  
##  1st Qu.:4.083   1st Qu.:0.6110   1st Qu.:4.000   1st Qu.:1.000  
##  Median :4.454   Median :0.6487   Median :6.000   Median :2.000  
##  Mean   :4.562   Mean   :0.6543   Mean   :5.333   Mean   :2.037  
##  3rd Qu.:5.106   3rd Qu.:0.7080   3rd Qu.:6.000   3rd Qu.:3.000  
##  Max.   :6.296   Max.   :0.7991   Max.   :6.000   Max.   :6.000  
##   stem_length       log_stem     
##  Min.   :1.476   Min.   :0.1691  
##  1st Qu.:2.262   1st Qu.:0.3544  
##  Median :2.522   Median :0.4017  
##  Mean   :2.585   Mean   :0.4040  
##  3rd Qu.:2.781   3rd Qu.:0.4442  
##  Max.   :4.273   Max.   :0.6307
ggqqplot(Anthrobacter_agilis.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Anthrobacter_agilis.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Anthrobacter_agilis.data$log_stem
## W = 0.9631, p-value = 0.09494
#p=0.09494, furfills normality assumtions 

anova_result <- aov(log_stem  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Anthrobacter_agilis.data ))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df    Sum Sq   Mean Sq F value Pr(>F)
## Residuals  1 0.0005196 0.0005196               
## 
## Error: trial:plate
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.002258 0.002258               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1 0.1727 0.17266   19.42 2.56e-05 ***
## Residuals 104 0.9246 0.00889                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p value=2.56e-05, Stem Length in this species is significantly different than control, 

#Plot
x<-(control_subset$stem_length)
y<-(Anthrobacter_agilis.data$stem_length)

data <- data.frame(
  Group = rep(c("Control", "Anthrobacter_agilis"), each = length(x)),
  Value = c(x, y)
)
# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Anthrobacter_agilis VS Control Stem Length",
       x = "Group",
       y = "Stem Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Anthrobacter_agilis" = "lightgreen"))

p 


#"Anuerinibacillus_sp."

#Create a subset 
Anuerinibacillus_sp.data <- subset(Data, species == "Anuerinibacillus_sp")
ggqqplot(Anuerinibacillus_sp.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Anuerinibacillus_sp.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Anuerinibacillus_sp.data$log_stem
## W = 0.9814, p-value = 0.5622
#p= 0.846 furfills normality assumtions 


anova_result <- aov(log_stem  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Anuerinibacillus_sp.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.02097 0.02097               
## 
## Error: trial:plate
##           Df    Sum Sq   Mean Sq F value Pr(>F)
## Residuals  1 0.0003953 0.0003953               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value Pr(>F)    
## species     1 0.3080 0.30804   41.31  4e-09 ***
## Residuals 104 0.7755 0.00746                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value= 4e-09,  significantly different.


#Plot
x<-(control_subset$stem_length)
y<-(Anuerinibacillus_sp.data$stem_length)

data <- data.frame(
  Group = rep(c("Control", "Anuerinibacillus_s"), each = length(x)),
  Value = c(x, y)
)
# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Anuerinibacillus_s VS Control Stem Length",
       x = "Group",
       y = "Stem Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Anuerinibacillus_s" = "lightgreen"))

p 


"Bacillus_albus"
## [1] "Bacillus_albus"
#Create a subset 
Bacillus_albus.data <- subset(Data, species == "bacillus_albus")
summary(Bacillus_albus.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length   
##  Length:54          Length:54          Min.   : 7.48   Length:54         
##  Class :character   Class :character   1st Qu.:16.75   Class :character  
##  Mode  :character   Mode  :character   Median :20.48   Mode  :character  
##                                        Mean   :21.94                     
##                                        3rd Qu.:28.02                     
##                                        Max.   :43.76                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.375   Min.   :0.5283   Min.   :4.000   Min.   :2.000  
##  1st Qu.:4.827   1st Qu.:0.6837   1st Qu.:4.500   1st Qu.:4.000  
##  Median :5.281   Median :0.7227   Median :6.000   Median :5.000  
##  Mean   :5.338   Mean   :0.7219   Mean   :5.481   Mean   :5.148  
##  3rd Qu.:5.948   3rd Qu.:0.7744   3rd Qu.:6.000   3rd Qu.:6.000  
##  Max.   :7.104   Max.   :0.8515   Max.   :6.000   Max.   :9.000  
##   stem_length       log_stem     
##  Min.   :1.511   Min.   :0.1793  
##  1st Qu.:2.144   1st Qu.:0.3312  
##  Median :2.372   Median :0.3751  
##  Mean   :2.416   Mean   :0.3755  
##  3rd Qu.:2.721   3rd Qu.:0.4347  
##  Max.   :3.757   Max.   :0.5748
ggqqplot(Bacillus_albus.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Bacillus_albus.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Bacillus_albus.data$log_stem
## W = 0.98081, p-value = 0.5356
# p-value = 0.5356, fulfills normality assumptions 


anova_result <- aov(log_stem  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Bacillus_albus.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.003132 0.003132               
## 
## Error: trial:plate
##           Df Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.0329  0.0329               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value  Pr(>F)   
## species     1 0.0718 0.07178   8.771 0.00379 **
## Residuals 104 0.8511 0.00818                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# p-value= 0.00379, suggesting significant difference of Stem Length measurements among this species and control 



#Plot ##Attempting to debug 
x<-(control_subset$stem_length)
y<-(Bacillus_albus.data$stem_length)

data <- data.frame(
  Group = rep(c("Control", "Bacillus_albus"), each = length(x)),
  Value = c(x, y)
)
# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Bacillus_albus VS Control Stem Length",
       x = "Group",
       y = "Stem Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Bacillus_albus" = "lightgreen"))

p 


"Bacillus_cerus"
## [1] "Bacillus_cerus"
#Create a subset 
Bacillus_cerus.data <- subset(Data, species == "Bacillus_cerus")
summary(Bacillus_cerus.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 4.737   Length:54         
##  Class :character   Class :character   1st Qu.:15.139   Class :character  
##  Mode  :character   Mode  :character   Median :22.985   Mode  :character  
##                                        Mean   :22.380                     
##                                        3rd Qu.:27.363                     
##                                        Max.   :41.627                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :1.361   Min.   :0.1339   Min.   :4.000   Min.   :2.000  
##  1st Qu.:2.778   1st Qu.:0.4438   1st Qu.:5.000   1st Qu.:4.000  
##  Median :4.443   Median :0.6476   Median :6.000   Median :5.000  
##  Mean   :4.189   Mean   :0.5836   Mean   :5.463   Mean   :4.778  
##  3rd Qu.:5.395   3rd Qu.:0.7319   3rd Qu.:6.000   3rd Qu.:6.000  
##  Max.   :7.622   Max.   :0.8820   Max.   :6.000   Max.   :9.000  
##   stem_length       log_stem      
##  Min.   :1.235   Min.   :0.09167  
##  1st Qu.:2.248   1st Qu.:0.35172  
##  Median :2.503   Median :0.39855  
##  Mean   :2.568   Mean   :0.39978  
##  3rd Qu.:2.938   3rd Qu.:0.46808  
##  Max.   :3.789   Max.   :0.57852
ggqqplot(Bacillus_cerus.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Bacillus_cerus.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Bacillus_cerus.data$log_stem
## W = 0.95797, p-value = 0.0559
# p-value= p-value = 0.0559 , does not furfills normality assumtions.


# Perform the Wilcoxon Rank Sum Test
wilcox_test <- wilcox.test(log_stem  ~ species, data = rbind(control_subset, Bacillus_cerus.data))
print(wilcox_test)
## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  log_stem by species
## W = 2125.5, p-value = 4.16e-05
## alternative hypothesis: true location shift is not equal to 0
#p-value =4.16e-05, significantly different, fail to reject the null hypothesis that there are no differences among Bacillus cerus Stem Length versus the control. 

#Plot
x<-(control_subset$stem_length)
y<-(Bacillus_cerus.data$stem_length)

data <- data.frame(
  Group = rep(c("Control", "Bacillus_cerus"), each = length(x)),
  Value = c(x, y)
)
# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Bacillus_cerus VS Control Stem Length",
       x = "Group",
       y = "Stem Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Bacillus_albus" = "lightgreen"))

p 


"Bacillus_mycodies"
## [1] "Bacillus_mycodies"
#Create a subset 
Bacillus_mycodies.data <- subset(Data, species == "Bacillus_mycodies")
summary(Bacillus_mycodies.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 9.423   Length:54         
##  Class :character   Class :character   1st Qu.:17.397   Class :character  
##  Mode  :character   Mode  :character   Median :26.843   Mode  :character  
##                                        Mean   :27.347                     
##                                        3rd Qu.:32.766                     
##                                        Max.   :64.685                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.624   Min.   :0.5592   Min.   :4.000   Min.   :1.000  
##  1st Qu.:4.407   1st Qu.:0.6441   1st Qu.:6.000   1st Qu.:3.000  
##  Median :4.673   Median :0.6696   Median :6.000   Median :4.000  
##  Mean   :4.724   Mean   :0.6714   Mean   :5.704   Mean   :3.981  
##  3rd Qu.:5.015   3rd Qu.:0.7002   3rd Qu.:6.000   3rd Qu.:5.000  
##  Max.   :6.074   Max.   :0.7834   Max.   :6.000   Max.   :8.000  
##   stem_length       log_stem     
##  Min.   :2.022   Min.   :0.3058  
##  1st Qu.:2.781   1st Qu.:0.4442  
##  Median :3.188   Median :0.5036  
##  Mean   :3.249   Mean   :0.5026  
##  3rd Qu.:3.715   3rd Qu.:0.5699  
##  Max.   :5.402   Max.   :0.7326
ggqqplot(Bacillus_mycodies.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Bacillus_mycodies.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Bacillus_mycodies.data$log_stem
## W = 0.98371, p-value = 0.6704
#furfills normality assumtions, p-value = 0.6704 


anova_result <- aov(log_stem  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Bacillus_mycodies.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df    Sum Sq   Mean Sq F value Pr(>F)
## Residuals  1 0.0001854 0.0001854               
## 
## Error: trial:plate
##           Df    Sum Sq   Mean Sq F value Pr(>F)
## Residuals  1 0.0003095 0.0003095               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1 0.8615  0.8615   92.98 4.23e-16 ***
## Residuals 104 0.9636  0.0093                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# p-value=4.23e-16, suggesting significantly different Stem Lengths from control. 


#Plot
x<-(control_subset$stem_length)
y<-(Bacillus_mycodies.data$stem_length)

data <- data.frame(
  Group = rep(c("Control", "Bacillus_mycodies"), each = length(x)),
  Value = c(x, y)
)
# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Bacillus_mycodies VS Control Stem Length",
       x = "Group",
       y = "Stem Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Bacillus_mycodies" = "lightgreen"))

p 


"Bacillus paramycoides" 
## [1] "Bacillus paramycoides"
#Create a subset 
Bacillus_paramycoides.data <- subset(Data, species == "Bacillus_paramycoides")
summary(Bacillus_paramycoides.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 6.373   Length:54         
##  Class :character   Class :character   1st Qu.:11.190   Class :character  
##  Mode  :character   Mode  :character   Median :14.354   Mode  :character  
##                                        Mean   :14.733                     
##                                        3rd Qu.:16.812                     
##                                        Max.   :29.675                     
##  leaf_average_     log_leaf_avg      leaf_count    lateral_roots   
##  Min.   : 3.818   Min.   :0.5818   Min.   :2.000   Min.   : 1.000  
##  1st Qu.: 4.654   1st Qu.:0.6678   1st Qu.:4.000   1st Qu.: 1.250  
##  Median : 5.167   Median :0.7133   Median :6.000   Median : 2.000  
##  Mean   : 5.678   Mean   :0.7413   Mean   :5.222   Mean   : 2.741  
##  3rd Qu.: 6.359   3rd Qu.:0.8033   3rd Qu.:6.000   3rd Qu.: 3.000  
##  Max.   :11.180   Max.   :1.0484   Max.   :6.000   Max.   :12.000  
##   stem_length       log_stem     
##  Min.   :1.372   Min.   :0.1374  
##  1st Qu.:2.316   1st Qu.:0.3648  
##  Median :2.650   Median :0.4232  
##  Mean   :2.593   Mean   :0.4042  
##  3rd Qu.:2.864   3rd Qu.:0.4569  
##  Max.   :3.801   Max.   :0.5799
ggqqplot(Bacillus_paramycoides.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Bacillus_paramycoides.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Bacillus_paramycoides.data$log_stem
## W = 0.95805, p-value = 0.05635
#p-value = 0.009642, does furfill normality assumtions 

anova_result <- aov(log_stem  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Bacillus_paramycoides.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.01185 0.01185               
## 
## Error: trial:plate
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.02565 0.02565               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1 0.1738 0.17382   18.68 3.55e-05 ***
## Residuals 104 0.9678 0.00931                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value=3.55e-05

#Plot
x<-(control_subset$stem_length)
y<-(Bacillus_paramycoides.data$stem_length)

data <- data.frame(
  Group = rep(c("Control", "Bacillus_paramycoides"), each = length(x)),
  Value = c(x, y)
)
# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Bacillus_paramycoides VS Control Stem Length",
       x = "Group",
       y = "Stem Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Bacillus_paramycoides" = "lightgreen"))

p 


"Bacillus proteolyti"
## [1] "Bacillus proteolyti"
Bacillus_proteolyti.data <- subset(Data, species == "Bacillus_proteolyti")
summary(Bacillus_proteolyti.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##                                                                              
##    species           species_ID         root_length_   log_root_length   
##  Length:54          Length:54          Min.   :10.29   Length:54         
##  Class :character   Class :character   1st Qu.:19.15   Class :character  
##  Mode  :character   Mode  :character   Median :24.42   Mode  :character  
##                                        Mean   :24.75                     
##                                        3rd Qu.:29.24                     
##                                        Max.   :45.16                     
##                                                                          
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.535   Min.   :0.5485   Min.   :4.000   Min.   : 1.00  
##  1st Qu.:4.322   1st Qu.:0.6357   1st Qu.:4.000   1st Qu.: 3.00  
##  Median :4.793   Median :0.6806   Median :5.500   Median : 4.00  
##  Mean   :4.979   Mean   :0.6901   Mean   :5.056   Mean   : 4.66  
##  3rd Qu.:5.603   3rd Qu.:0.7484   3rd Qu.:6.000   3rd Qu.: 6.00  
##  Max.   :7.136   Max.   :0.8534   Max.   :6.000   Max.   :17.00  
##                                                   NA's   :1      
##   stem_length       log_stem     
##  Min.   :2.010   Min.   :0.3032  
##  1st Qu.:2.516   1st Qu.:0.4007  
##  Median :2.803   Median :0.4476  
##  Mean   :2.952   Mean   :0.4609  
##  3rd Qu.:3.266   3rd Qu.:0.5139  
##  Max.   :5.777   Max.   :0.7617  
## 
ggqqplot(Bacillus_proteolyti.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Bacillus_proteolyti.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Bacillus_proteolyti.data$log_stem
## W = 0.96582, p-value = 0.1256
#p-value = 0.1256, furfills normality assumtions 


anova_result <- aov(log_stem  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Bacillus_proteolyti.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df    Sum Sq   Mean Sq F value Pr(>F)
## Residuals  1 1.209e-05 1.209e-05               
## 
## Error: trial:plate
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.02751 0.02751               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1 0.5065  0.5065   57.48 1.49e-11 ***
## Residuals 104 0.9164  0.0088                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# p-value=1.49e-11 , suggesting statistically significant. 

#Plot
x<-(control_subset$stem_length)
y<-(Bacillus_proteolyti.data$stem_length)

data <- data.frame(
  Group = rep(c("Control", "Bacillus_proteolyti"), each = length(x)),
  Value = c(x, y)
)
# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Bacillus_proteolyti VS Control Stem Length",
       x = "Group",
       y = "Stem Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Bacillus_proteolyti" = "lightgreen"))

p 


"Bacillus thuringiensis"
## [1] "Bacillus thuringiensis"
Bacillus_thuringiensis.data <- subset(Data, species == "Bacillus_thuringiensis")
summary(Bacillus_thuringiensis.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length   
##  Length:54          Length:54          Min.   :12.55   Length:54         
##  Class :character   Class :character   1st Qu.:19.62   Class :character  
##  Mode  :character   Mode  :character   Median :26.49   Mode  :character  
##                                        Mean   :28.45                     
##                                        3rd Qu.:36.23                     
##                                        Max.   :52.01                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :4.254   Min.   :0.6288   Min.   :4.000   Min.   :2.000  
##  1st Qu.:5.048   1st Qu.:0.7031   1st Qu.:6.000   1st Qu.:4.000  
##  Median :5.463   Median :0.7374   Median :6.000   Median :5.000  
##  Mean   :5.694   Mean   :0.7504   Mean   :5.944   Mean   :5.407  
##  3rd Qu.:6.128   3rd Qu.:0.7873   3rd Qu.:6.000   3rd Qu.:7.750  
##  Max.   :8.762   Max.   :0.9426   Max.   :8.000   Max.   :9.000  
##   stem_length       log_stem      
##  Min.   :1.255   Min.   :0.09864  
##  1st Qu.:2.221   1st Qu.:0.34654  
##  Median :2.516   Median :0.40071  
##  Mean   :2.613   Mean   :0.40581  
##  3rd Qu.:3.065   3rd Qu.:0.48643  
##  Max.   :4.109   Max.   :0.61374
ggqqplot(Bacillus_thuringiensis.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Bacillus_thuringiensis.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Bacillus_thuringiensis.data$log_stem
## W = 0.98516, p-value = 0.7391
#p-value = 0.7391,does fulfill normality assumptions 

anova_result <- aov(log_stem  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Bacillus_thuringiensis.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.0242  0.0242               
## 
## Error: trial:plate
##           Df    Sum Sq   Mean Sq F value Pr(>F)
## Residuals  1 0.0009108 0.0009108               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1 0.1808  0.1807    17.9 5.03e-05 ***
## Residuals 104 1.0501  0.0101                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value =5.03e-05, suggesting significantly different. 

#Plot
x<-(control_subset$stem_length)
y<-(Bacillus_thuringiensis.data$stem_length)

data <- data.frame(
  Group = rep(c("Control", "Bacillus_thuringiensis"), each = length(x)),
  Value = c(x, y)
)

# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
 labs(title = "Bacillus_thuringiensis VS Control Stem Length Average",
       x = "Group",
       y = "Stem Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Bacillus_thuringiensis" = "lightgreen"))

p 


Micobacterium_sp.data <- subset(Data, species == "Micobacterium_sp")
summary(Micobacterium_sp.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##                                                                              
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 9.051   Length:54         
##  Class :character   Class :character   1st Qu.:14.818   Class :character  
##  Mode  :character   Mode  :character   Median :17.951   Mode  :character  
##                                        Mean   :19.817                     
##                                        3rd Qu.:23.566                     
##                                        Max.   :45.558                     
##                                                                           
##  leaf_average_    log_leaf_avg      leaf_count   lateral_roots  
##  Min.   :3.166   Min.   :0.5005   Min.   :4.00   Min.   :3.000  
##  1st Qu.:3.942   1st Qu.:0.5958   1st Qu.:6.00   1st Qu.:4.250  
##  Median :4.580   Median :0.6609   Median :6.00   Median :5.500  
##  Mean   :4.599   Mean   :0.6559   Mean   :5.83   Mean   :5.519  
##  3rd Qu.:5.079   3rd Qu.:0.7058   3rd Qu.:6.00   3rd Qu.:6.000  
##  Max.   :6.821   Max.   :0.8338   Max.   :6.00   Max.   :9.000  
##                                   NA's   :1                     
##   stem_length       log_stem     
##  Min.   :1.396   Min.   :0.1449  
##  1st Qu.:2.049   1st Qu.:0.3114  
##  Median :2.394   Median :0.3792  
##  Mean   :2.465   Mean   :0.3818  
##  3rd Qu.:2.708   3rd Qu.:0.4326  
##  Max.   :3.739   Max.   :0.5728  
## 
ggqqplot(Micobacterium_sp.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Micobacterium_sp.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Micobacterium_sp.data$log_stem
## W = 0.98756, p-value = 0.8456
#p-value = 0.5708,furfills normality assumtions 


anova_result <- aov(log_stem  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Micobacterium_sp.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.01187 0.01187               
## 
## Error: trial:plate
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.001993 0.001993               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value  Pr(>F)   
## species     1 0.0901 0.09011   9.435 0.00272 **
## Residuals 104 0.9933 0.00955                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value=0.00272, statistically significant.

#Plot
x<-(control_subset$stem_length)
y<-(Micobacterium_sp.data$stem_length)

data <- data.frame(
  Group = rep(c("Control", "Micobacterium_sp"), each = length(x)),
  Value = c(x, y)
)

# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
 labs(title = "Micobacterium_sp VS Control Stem Length Average",
       x = "Group",
       y = "Stem Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Micobacterium_sp" = "lightgreen"))

p 


"Microbacterium_oxydans"
## [1] "Microbacterium_oxydans"
Microbacterium_oxydans.data <- subset(Data, species == "Microbacterium_oxydans")
summary(Microbacterium_oxydans.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 2.518   Length:54         
##  Class :character   Class :character   1st Qu.:12.134   Class :character  
##  Mode  :character   Mode  :character   Median :19.643   Mode  :character  
##                                        Mean   :21.879                     
##                                        3rd Qu.:29.620                     
##                                        Max.   :56.961                     
##  leaf_average_    log_leaf_avg      leaf_count     lateral_roots   
##  Min.   :3.574   Min.   :0.5531   Min.   : 4.000   Min.   : 0.000  
##  1st Qu.:4.504   1st Qu.:0.6535   1st Qu.: 4.000   1st Qu.: 3.250  
##  Median :4.878   Median :0.6882   Median : 5.000   Median : 5.000  
##  Mean   :5.136   Mean   :0.7052   Mean   : 5.926   Mean   : 5.407  
##  3rd Qu.:5.774   3rd Qu.:0.7615   3rd Qu.: 6.000   3rd Qu.: 6.000  
##  Max.   :7.236   Max.   :0.8595   Max.   :55.000   Max.   :65.000  
##   stem_length       log_stem     
##  Min.   :1.689   Min.   :0.2276  
##  1st Qu.:2.653   1st Qu.:0.4237  
##  Median :3.220   Median :0.5078  
##  Mean   :3.224   Mean   :0.4980  
##  3rd Qu.:3.720   3rd Qu.:0.5705  
##  Max.   :4.986   Max.   :0.6978
ggqqplot(Microbacterium_oxydans.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Microbacterium_oxydans.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Microbacterium_oxydans.data$log_stem
## W = 0.96966, p-value = 0.1862
#p-value = 0.1862 furfills normality assumtions 


anova_result <- aov(log_stem  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Microbacterium_oxydans.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.06897 0.06897               
## 
## Error: trial:plate
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.004345 0.004345               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1  0.818  0.8180   88.15 1.56e-15 ***
## Residuals 104  0.965  0.0093                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value =1.56e-15 , suggesting significantly different 


#Plot
x<-(control_subset$stem_length)
y<-(Microbacterium_oxydans.data$stem_length)

data <- data.frame(
  Group = rep(c("Control", "Microbacterium_oxydans"), each = length(x)),
  Value = c(x, y)
)

# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Microbacterium_oxydans VS Control Stem Length",
       x = "Group",
       y = "Stem Length mm") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Microbacterium_oxydans" = "lightgreen"))

p 


"Paenibacillus_sp."
## [1] "Paenibacillus_sp."
Paenibacillus_sp.data <- subset(Data, species == "Paenibacillus_sp")
summary(Paenibacillus_sp.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length   
##  Length:54          Length:54          Min.   :11.91   Length:54         
##  Class :character   Class :character   1st Qu.:19.66   Class :character  
##  Mode  :character   Mode  :character   Median :24.38   Mode  :character  
##                                        Mean   :24.35                     
##                                        3rd Qu.:27.73                     
##                                        Max.   :41.75                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :2.244   Min.   :0.3511   Min.   :4.000   Min.   :2.000  
##  1st Qu.:4.978   1st Qu.:0.6970   1st Qu.:4.000   1st Qu.:4.000  
##  Median :5.403   Median :0.7327   Median :4.000   Median :5.000  
##  Mean   :5.339   Mean   :0.7204   Mean   :4.926   Mean   :5.019  
##  3rd Qu.:5.808   3rd Qu.:0.7640   3rd Qu.:6.000   3rd Qu.:6.000  
##  Max.   :7.251   Max.   :0.8604   Max.   :6.000   Max.   :9.000  
##   stem_length       log_stem     
##  Min.   :1.545   Min.   :0.1889  
##  1st Qu.:2.329   1st Qu.:0.3672  
##  Median :2.651   Median :0.4235  
##  Mean   :2.790   Mean   :0.4338  
##  3rd Qu.:3.162   3rd Qu.:0.5000  
##  Max.   :4.483   Max.   :0.6516
ggqqplot(Paenibacillus_sp.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Paenibacillus_sp.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Paenibacillus_sp.data$log_stem
## W = 0.98643, p-value = 0.7972
#p-value = 0.7972, does fulfill normality assumptions 

anova_result <- aov(log_stem  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Paenibacillus_sp.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.01143 0.01143               
## 
## Error: trial:plate
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.009692 0.009692               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1 0.3258  0.3258   31.75 1.51e-07 ***
## Residuals 104 1.0672  0.0103                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value = 1.51e-07, suggesting significantly different. 

#Plot
x<-(control_subset$stem_length)
y<-(Paenibacillus_sp.data$stem_length)

data <- data.frame(
  Group = rep(c("Control", "Paenibacillus_sp"), each = length(x)),
  Value = c(x, y)
)

# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Paenibacillus_sp VS Control Stem Length",
       x = "Group",
       y = "Stem Length mm") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Paenibacillus_sp" = "lightgreen"))

p 


"Alternaria_alternata"
## [1] "Alternaria_alternata"
Alternaria_alternata.data <- subset(Data, species == "Alternaria_alternata")
summary(Alternaria_alternata.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 7.944   Length:54         
##  Class :character   Class :character   1st Qu.:18.028   Class :character  
##  Mode  :character   Mode  :character   Median :20.572   Mode  :character  
##                                        Mean   :22.258                     
##                                        3rd Qu.:26.841                     
##                                        Max.   :38.574                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :2.759   Min.   :0.4408   Min.   :4.000   Min.   :2.000  
##  1st Qu.:4.460   1st Qu.:0.6493   1st Qu.:6.000   1st Qu.:3.000  
##  Median :5.208   Median :0.7167   Median :6.000   Median :4.000  
##  Mean   :5.583   Mean   :0.7329   Mean   :5.907   Mean   :4.167  
##  3rd Qu.:6.651   3rd Qu.:0.8229   3rd Qu.:6.000   3rd Qu.:5.750  
##  Max.   :8.947   Max.   :0.9517   Max.   :8.000   Max.   :7.000  
##   stem_length       log_stem     
##  Min.   :1.445   Min.   :0.1599  
##  1st Qu.:1.940   1st Qu.:0.2877  
##  Median :2.212   Median :0.3447  
##  Mean   :2.352   Mean   :0.3596  
##  3rd Qu.:2.637   3rd Qu.:0.4211  
##  Max.   :4.179   Max.   :0.6211
ggqqplot(Alternaria_alternata.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Alternaria_alternata.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Alternaria_alternata.data$log_stem
## W = 0.98314, p-value = 0.6432
#p-value =  0.6432, fulfills normality assumptions 


anova_result <- aov(log_stem  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Alternaria_alternata.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.03383 0.03383               
## 
## Error: trial:plate
##           Df    Sum Sq   Mean Sq F value Pr(>F)
## Residuals  1 0.0008565 0.0008565               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value Pr(>F)  
## species     1 0.0342 0.03419   3.414 0.0675 .
## Residuals 104 1.0417 0.01002                 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# p-value= 0.0675, not significantly different. 
"Cladosporium_sp."
## [1] "Cladosporium_sp."
Cladosporium_sp.data <- subset(Data, species == "Cladosporium_sp.")
summary(Cladosporium_sp.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 4.253   Length:54         
##  Class :character   Class :character   1st Qu.:11.737   Class :character  
##  Mode  :character   Mode  :character   Median :15.358   Mode  :character  
##                                        Mean   :15.841                     
##                                        3rd Qu.:19.161                     
##                                        Max.   :29.520                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.115   Min.   :0.4935   Min.   :4.000   Min.   :2.000  
##  1st Qu.:4.125   1st Qu.:0.6154   1st Qu.:4.000   1st Qu.:2.000  
##  Median :4.651   Median :0.6675   Median :4.000   Median :2.000  
##  Mean   :4.675   Mean   :0.6628   Mean   :4.704   Mean   :2.815  
##  3rd Qu.:5.243   3rd Qu.:0.7195   3rd Qu.:6.000   3rd Qu.:4.000  
##  Max.   :6.526   Max.   :0.8146   Max.   :6.000   Max.   :6.000  
##   stem_length       log_stem      
##  Min.   :0.317   Min.   :-0.4989  
##  1st Qu.:2.243   1st Qu.: 0.3508  
##  Median :2.653   Median : 0.4237  
##  Mean   :2.670   Mean   : 0.4041  
##  3rd Qu.:3.075   3rd Qu.: 0.4879  
##  Max.   :5.808   Max.   : 0.7640
ggqqplot(Cladosporium_sp.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Cladosporium_sp.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Cladosporium_sp.data$log_stem
## W = 0.7299, p-value = 1.233e-08
#p-value = 1.233e-08, does not furfills normality assumtions 

wilcox_test <- wilcox.test(log_stem  ~ species, data = rbind(control_subset, Cladosporium_sp.data))
print(wilcox_test)
## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  log_stem by species
## W = 2163, p-value = 1.499e-05
## alternative hypothesis: true location shift is not equal to 0
#p-value = 1.499e-05

#Plot
x<-(control_subset$stem_length)
y<-(Cladosporium_sp.data$stem_length)

data <- data.frame(
  Group = rep(c("Control", "Cladosporium_sp."), each = length(x)),
  Value = c(x, y)
)

# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Cladosporium_sp. VS Control Stem Length",
       x = "Group",
       y = "Stem Length mm") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Cladosporium_sp." = "lightgreen"))

p 


"Didymella_americana"
## [1] "Didymella_americana"
Didymella_americana.data <- subset(Data, species == "Didymella_americana")
summary(Didymella_americana.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 9.054   Length:54         
##  Class :character   Class :character   1st Qu.:18.033   Class :character  
##  Mode  :character   Mode  :character   Median :28.211   Mode  :character  
##                                        Mean   :30.541                     
##                                        3rd Qu.:39.836                     
##                                        Max.   :65.382                     
##  leaf_average_     log_leaf_avg      leaf_count    lateral_roots   
##  Min.   : 2.901   Min.   :0.4625   Min.   :4.000   Min.   : 2.000  
##  1st Qu.: 4.807   1st Qu.:0.6819   1st Qu.:5.250   1st Qu.: 5.250  
##  Median : 7.732   Median :0.8883   Median :6.000   Median : 8.000  
##  Mean   : 7.334   Mean   :0.8382   Mean   :5.648   Mean   : 9.093  
##  3rd Qu.: 9.031   3rd Qu.:0.9556   3rd Qu.:6.000   3rd Qu.:10.000  
##  Max.   :13.024   Max.   :1.1147   Max.   :6.000   Max.   :67.000  
##   stem_length       log_stem     
##  Min.   :1.416   Min.   :0.1511  
##  1st Qu.:1.978   1st Qu.:0.2961  
##  Median :2.292   Median :0.3601  
##  Mean   :2.347   Mean   :0.3601  
##  3rd Qu.:2.696   3rd Qu.:0.4308  
##  Max.   :3.631   Max.   :0.5600
ggqqplot(Didymella_americana.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Didymella_americana.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Didymella_americana.data$log_stem
## W = 0.98843, p-value = 0.8797
#p-value = 0.8797, does furfill normality assumtions 

anova_result <- aov(log_stem  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Didymella_americana.data))
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.01865 0.01865               
## 
## Error: trial:plate
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.009993 0.009993               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value Pr(>F)  
## species     1 0.0352 0.03516   3.653 0.0587 .
## Residuals 104 1.0011 0.00963                 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value = 0.0587 , not statistically significant
"Filobasidium_floriflorm"
## [1] "Filobasidium_floriflorm"
Filobasidium_floriflorm.data <- subset(Data, species == "Filobasidium_floriflorm")
summary(Filobasidium_floriflorm.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length   
##  Length:54          Length:54          Min.   :11.80   Length:54         
##  Class :character   Class :character   1st Qu.:20.27   Class :character  
##  Mode  :character   Mode  :character   Median :24.02   Mode  :character  
##                                        Mean   :25.40                     
##                                        3rd Qu.:31.32                     
##                                        Max.   :44.20                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots   
##  Min.   :3.571   Min.   :0.5527   Min.   :4.000   Min.   : 0.000  
##  1st Qu.:4.410   1st Qu.:0.6444   1st Qu.:5.000   1st Qu.: 6.000  
##  Median :4.827   Median :0.6837   Median :6.000   Median : 8.000  
##  Mean   :4.861   Mean   :0.6821   Mean   :5.444   Mean   : 8.241  
##  3rd Qu.:5.309   3rd Qu.:0.7250   3rd Qu.:6.000   3rd Qu.:10.750  
##  Max.   :7.411   Max.   :0.8699   Max.   :7.000   Max.   :17.000  
##   stem_length       log_stem     
##  Min.   :1.306   Min.   :0.1159  
##  1st Qu.:2.049   1st Qu.:0.3116  
##  Median :2.381   Median :0.3767  
##  Mean   :2.404   Mean   :0.3698  
##  3rd Qu.:2.646   3rd Qu.:0.4226  
##  Max.   :3.670   Max.   :0.5647
ggqqplot(Filobasidium_floriflorm.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Filobasidium_floriflorm.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Filobasidium_floriflorm.data$log_stem
## W = 0.98438, p-value = 0.7021
#p-value = 0.7021furfills normality assumtions 

anova_result <- aov(log_stem  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Filobasidium_floriflorm.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.04218 0.04218               
## 
## Error: trial:plate
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.03062 0.03062               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value Pr(>F)  
## species     1 0.0567 0.05666   5.968 0.0163 *
## Residuals 104 0.9875 0.00950                 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value=0.0163, significantly different

#Plot
x<-(control_subset$stem_length)
y<-(Filobasidium_floriflorm.data$stem_length)

data <- data.frame(
  Group = rep(c("Control", "Filobasidium_floriflorm"), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Filobasidium_floriflorm VS COntrol Stem length",
       x = "Group",
       y = "Stem Length") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Filobasidium_floriflorm" = "lightgreen"))

p 


"Fusarium_equiseti"
## [1] "Fusarium_equiseti"
Fusarium_equiseti.data <- subset(Data, species == "Fusarium_equiseti")
summary(Fusarium_equiseti.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 7.576   Length:54         
##  Class :character   Class :character   1st Qu.:12.081   Class :character  
##  Mode  :character   Mode  :character   Median :14.280   Mode  :character  
##                                        Mean   :15.041                     
##                                        3rd Qu.:17.196                     
##                                        Max.   :25.450                     
##  leaf_average_    log_leaf_avg      leaf_count   lateral_roots  stem_length   
##  Min.   :1.928   Min.   :0.2851   Min.   :4.00   Min.   : 2    Min.   :0.888  
##  1st Qu.:2.873   1st Qu.:0.4583   1st Qu.:4.00   1st Qu.: 4    1st Qu.:1.627  
##  Median :3.449   Median :0.5377   Median :5.00   Median : 6    Median :1.855  
##  Mean   :3.553   Mean   :0.5366   Mean   :4.87   Mean   : 7    Mean   :1.848  
##  3rd Qu.:4.201   3rd Qu.:0.6233   3rd Qu.:6.00   3rd Qu.: 9    3rd Qu.:2.109  
##  Max.   :6.246   Max.   :0.7956   Max.   :6.00   Max.   :16    Max.   :3.299  
##     log_stem       
##  Min.   :-0.05159  
##  1st Qu.: 0.21139  
##  Median : 0.26833  
##  Mean   : 0.25393  
##  3rd Qu.: 0.32408  
##  Max.   : 0.51838
summary(control_subset)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 8.128   Length:54         
##  Class :character   Class :character   1st Qu.:13.794   Class :character  
##  Mode  :character   Mode  :character   Median :17.407   Mode  :character  
##                                        Mean   :18.637                     
##                                        3rd Qu.:21.004                     
##                                        Max.   :34.876                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots   
##  Min.   :3.462   Min.   :0.5393   Min.   :4.000   Min.   : 2.000  
##  1st Qu.:3.988   1st Qu.:0.6008   1st Qu.:4.000   1st Qu.: 5.000  
##  Median :4.497   Median :0.6529   Median :6.000   Median : 7.000  
##  Mean   :4.586   Mean   :0.6563   Mean   :5.222   Mean   : 7.093  
##  3rd Qu.:5.244   3rd Qu.:0.7197   3rd Qu.:6.000   3rd Qu.: 9.000  
##  Max.   :5.962   Max.   :0.7754   Max.   :6.000   Max.   :15.000  
##   stem_length       log_stem       
##  Min.   :1.005   Min.   :0.002166  
##  1st Qu.:1.842   1st Qu.:0.265289  
##  Median :2.119   Median :0.326130  
##  Mean   :2.162   Mean   :0.323987  
##  3rd Qu.:2.419   3rd Qu.:0.383591  
##  Max.   :3.368   Max.   :0.527372
ggqqplot(Fusarium_equiseti.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Fusarium_equiseti.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Fusarium_equiseti.data$log_stem
## W = 0.94113, p-value = 0.01039
#  p-value =  0.01039, does not fulfill normality assumptions.

wilcox_test <- wilcox.test(log_stem  ~ species, data = rbind(control_subset, Fusarium_equiseti.data))
print(wilcox_test)
## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  log_stem by species
## W = 2022.5, p-value = 0.0005291
## alternative hypothesis: true location shift is not equal to 0
#p-value=  0.0005291, significantly different

#Plot
data <- data.frame(
  Group = rep(c("Control", "Fusarium_equiseti"), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Fusarium_equiseti VS Control Stem Length",
       x = "Group",
       y = "Stem Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        legend.title = element_text(size = 10),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue","Fusarium_equiseti" = "lightgreen"))


p 


'Naganishia_albidus'
## [1] "Naganishia_albidus"
Naganishia_albidus.data <- subset(Data, species == "Naganishia_albidus")
summary(Naganishia_albidus.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 9.227   Length:54         
##  Class :character   Class :character   1st Qu.:18.879   Class :character  
##  Mode  :character   Mode  :character   Median :28.444   Mode  :character  
##                                        Mean   :28.930                     
##                                        3rd Qu.:38.758                     
##                                        Max.   :53.584                     
##  leaf_average_    log_leaf_avg      leaf_count   lateral_roots   
##  Min.   :3.183   Min.   :0.5028   Min.   :4.00   Min.   : 2.000  
##  1st Qu.:4.381   1st Qu.:0.6416   1st Qu.:6.00   1st Qu.: 4.000  
##  Median :4.812   Median :0.6823   Median :6.00   Median : 6.000  
##  Mean   :5.109   Mean   :0.6988   Mean   :5.87   Mean   : 7.148  
##  3rd Qu.:5.936   3rd Qu.:0.7735   3rd Qu.:6.00   3rd Qu.: 8.000  
##  Max.   :8.018   Max.   :0.9040   Max.   :7.00   Max.   :17.000  
##   stem_length       log_stem     
##  Min.   :1.584   Min.   :0.1998  
##  1st Qu.:2.165   1st Qu.:0.3355  
##  Median :2.438   Median :0.3871  
##  Mean   :2.521   Mean   :0.3920  
##  3rd Qu.:2.847   3rd Qu.:0.4544  
##  Max.   :3.891   Max.   :0.5901
ggqqplot(Naganishia_albidus.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Naganishia_albidus.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Naganishia_albidus.data$log_stem
## W = 0.98685, p-value = 0.8155
# p-value = 0.8155, furfills normality assumtions 

anova_result <- aov(log_stem  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Naganishia_albidus.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.06095 0.06095               
## 
## Error: trial:plate
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.01905 0.01905               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1 0.1250 0.12504   14.48 0.000239 ***
## Residuals 104 0.8977 0.00863                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# p-value= 0.000239

#Plot
x<-(control_subset$stem_length)
y<-(Naganishia_albidus.data$stem_length)

data <- data.frame(
  Group = rep(c("Control", "Naganishia_albidus"), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Naganishia_albidus VS Control Stem Length",
       x = "Group",
       y = "Stem Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Naganishia_albidus" = "lightgreen"))

p 


"Subramaniula_cuniculorum"
## [1] "Subramaniula_cuniculorum"
Subramaniula_cuniculorum.data <- subset(Data, species == "Subramaniula_c.")
summary(Subramaniula_cuniculorum.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length   
##  Length:54          Length:54          Min.   :12.73   Length:54         
##  Class :character   Class :character   1st Qu.:21.33   Class :character  
##  Mode  :character   Mode  :character   Median :25.57   Mode  :character  
##                                        Mean   :25.93                     
##                                        3rd Qu.:29.10                     
##                                        Max.   :42.50                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.780   Min.   :0.5774   Min.   :4.000   Min.   :0.000  
##  1st Qu.:4.540   1st Qu.:0.6571   1st Qu.:5.000   1st Qu.:2.000  
##  Median :5.136   Median :0.7106   Median :6.000   Median :3.000  
##  Mean   :5.542   Mean   :0.7313   Mean   :5.426   Mean   :3.204  
##  3rd Qu.:6.120   3rd Qu.:0.7867   3rd Qu.:6.000   3rd Qu.:4.000  
##  Max.   :9.502   Max.   :0.9778   Max.   :6.000   Max.   :8.000  
##   stem_length       log_stem       
##  Min.   :1.006   Min.   :0.002598  
##  1st Qu.:1.919   1st Qu.:0.283010  
##  Median :2.437   Median :0.386746  
##  Mean   :2.572   Mean   :0.380294  
##  3rd Qu.:3.039   3rd Qu.:0.482802  
##  Max.   :7.868   Max.   :0.895864
ggqqplot(Subramaniula_cuniculorum.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Subramaniula_cuniculorum.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Subramaniula_cuniculorum.data$log_stem
## W = 0.9782, p-value = 0.4272
# p-value = 0.4272 does  furfill normality assumtions 

anova_result <- aov(log_stem  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Subramaniula_cuniculorum.data))
 #rbind combines the two subsets 
 #This code includes the nested factors (trial and plate) as random effects
 summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.03596 0.03596               
## 
## Error: trial:plate
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.008401 0.008401               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value Pr(>F)  
## species     1 0.0856 0.08560   4.814 0.0305 *
## Residuals 104 1.8495 0.01778                 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value=0.0305
 
x<-(control_subset$stem_length)
y<-(Subramaniula_cuniculorum.data$stem_length)


#Plot
data <- data.frame(
  Group = rep(c("Control", "Subramaniula_cuniculorum"), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Subramaniula_cuniculorum VS Control Stem Length",
       x = "Group",
       y = "Stem Length") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Subramaniula_cuniculorum" = "lightgreen"))

p 


"Westerdykella_centenaria"
## [1] "Westerdykella_centenaria"
Westerdykella_centenaria.data <- subset(Data, species == "Westerdykella_centenaria")
summary(Westerdykella_centenaria.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length   
##  Length:54          Length:54          Min.   : 0.00   Length:54         
##  Class :character   Class :character   1st Qu.:12.57   Class :character  
##  Mode  :character   Mode  :character   Median :18.32   Mode  :character  
##                                        Mean   :20.26                     
##                                        3rd Qu.:25.97                     
##                                        Max.   :45.79                     
##  leaf_average_     log_leaf_avg      leaf_count    lateral_roots   
##  Min.   : 2.412   Min.   :0.3824   Min.   :4.000   Min.   : 2.000  
##  1st Qu.: 4.170   1st Qu.:0.6202   1st Qu.:6.000   1st Qu.: 4.250  
##  Median : 4.947   Median :0.6943   Median :6.000   Median : 7.000  
##  Mean   : 5.065   Mean   :0.6846   Mean   :5.611   Mean   : 6.944  
##  3rd Qu.: 5.450   3rd Qu.:0.7364   3rd Qu.:6.000   3rd Qu.: 8.750  
##  Max.   :10.015   Max.   :1.0007   Max.   :6.000   Max.   :15.000  
##   stem_length       log_stem     
##  Min.   :1.363   Min.   :0.1345  
##  1st Qu.:1.840   1st Qu.:0.2648  
##  Median :2.134   Median :0.3292  
##  Mean   :2.120   Mean   :0.3194  
##  3rd Qu.:2.374   3rd Qu.:0.3754  
##  Max.   :3.179   Max.   :0.5023
ggqqplot(Westerdykella_centenaria.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Westerdykella_centenaria.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Westerdykella_centenaria.data$log_stem
## W = 0.98764, p-value = 0.8488
# p-value = 0.8488,furfills normality assumtions 

anova_result <- aov(log_stem  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Westerdykella_centenaria.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df    Sum Sq   Mean Sq F value Pr(>F)
## Residuals  1 0.0008337 0.0008337               
## 
## Error: trial:plate
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.003303 0.003303               
## 
## Error: Within
##            Df Sum Sq  Mean Sq F value Pr(>F)
## species     1 0.0006 0.000569   0.069  0.793
## Residuals 104 0.8548 0.008220
#p-value= 0.793, not significant difference 
"Phoma sp. 301"
## [1] "Phoma sp. 301"
Phoma_sp301.data <- subset(Data, species_ID == "301ci57")
summary(Phoma_sp301.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length   
##  Length:54          Length:54          Min.   :10.83   Length:54         
##  Class :character   Class :character   1st Qu.:19.00   Class :character  
##  Mode  :character   Mode  :character   Median :24.94   Mode  :character  
##                                        Mean   :25.08                     
##                                        3rd Qu.:30.72                     
##                                        Max.   :46.63                     
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots   
##  Min.   :3.318   Min.   :0.5209   Min.   :4.000   Min.   :  3.00  
##  1st Qu.:4.766   1st Qu.:0.6782   1st Qu.:5.000   1st Qu.:  6.00  
##  Median :5.738   Median :0.7587   Median :6.000   Median :  8.00  
##  Mean   :5.879   Mean   :0.7547   Mean   :5.667   Mean   : 22.83  
##  3rd Qu.:6.823   3rd Qu.:0.8340   3rd Qu.:6.000   3rd Qu.:  9.00  
##  Max.   :9.755   Max.   :0.9892   Max.   :7.000   Max.   :812.00  
##   stem_length       log_stem      
##  Min.   :1.077   Min.   :0.03222  
##  1st Qu.:1.657   1st Qu.:0.21942  
##  Median :1.895   Median :0.27772  
##  Mean   :1.965   Mean   :0.27984  
##  3rd Qu.:2.192   3rd Qu.:0.34079  
##  Max.   :3.306   Max.   :0.51930
ggqqplot(Phoma_sp301.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Phoma_sp301.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Phoma_sp301.data$log_stem
## W = 0.98099, p-value = 0.5435
# p-value= 0.5435 furfills normality assumtions 

anova_result <- aov(log_stem  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Phoma_sp301.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.002842 0.002842               
## 
## Error: trial:plate
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.02228 0.02228               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value Pr(>F)  
## species     1 0.0526 0.05261   4.797 0.0307 *
## Residuals 104 1.1406 0.01097                 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# p-value= 0.0307, significantly different.




#Plot
x<-(control_subset$stem_length)
y<-(Phoma_sp301.data$stem_length)

data <- data.frame(
  Group = rep(c("Control", "Phoma_sp301.data"), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Phoma VS Control Stem Length",
       x = "Group",
       y = "Stem Length") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Phoma_sp301" = "lightgreen"))


p 


"Phoma sp._313"
## [1] "Phoma sp._313"
Phoma_sp313.data <- subset(Data, species_ID == "313dri103")
summary(Phoma_sp313.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length   
##  Length:54          Length:54          Min.   : 7.576   Length:54         
##  Class :character   Class :character   1st Qu.:12.081   Class :character  
##  Mode  :character   Mode  :character   Median :14.280   Mode  :character  
##                                        Mean   :15.041                     
##                                        3rd Qu.:17.196                     
##                                        Max.   :25.450                     
##  leaf_average_    log_leaf_avg      leaf_count   lateral_roots  
##  Min.   :1.953   Min.   :0.2907   Min.   :4.00   Min.   :0.000  
##  1st Qu.:2.710   1st Qu.:0.4330   1st Qu.:4.00   1st Qu.:1.000  
##  Median :3.011   Median :0.4787   Median :6.00   Median :2.000  
##  Mean   :3.155   Mean   :0.4893   Mean   :5.37   Mean   :2.056  
##  3rd Qu.:3.452   3rd Qu.:0.5381   3rd Qu.:6.00   3rd Qu.:3.000  
##  Max.   :5.596   Max.   :0.7478   Max.   :7.00   Max.   :7.000  
##   stem_length        log_stem       
##  Min.   :0.6870   Min.   :-0.16304  
##  1st Qu.:0.9597   1st Qu.:-0.01794  
##  Median :1.2395   Median : 0.09324  
##  Mean   :1.3721   Mean   : 0.10114  
##  3rd Qu.:1.4500   3rd Qu.: 0.16136  
##  Max.   :4.8870   Max.   : 0.68904
ggqqplot(Phoma_sp313.data$log_stem ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Phoma_sp313.data$log_stem )
## 
##  Shapiro-Wilk normality test
## 
## data:  Phoma_sp313.data$log_stem
## W = 0.92762, p-value = 0.002939
#P-value= p-value = 0.3547. Does furfill normality assumtions 

anova_result <- aov(log_stem  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Phoma_sp313.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.2155  0.2155               
## 
## Error: trial:plate
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.05562 0.05562               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1  1.341  1.3408   81.08 1.12e-14 ***
## Residuals 104  1.720  0.0165                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value= 117.9 <2e-16, significantly different

#Plot
x<-(control_subset$stem_length)
y<-(Phoma_sp313.data $stem_length)


data <- data.frame(
  Group = rep(c("Control", "Phoma sp."), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Phoma sp. VS Control Stem Length",
       x = "Group",
       y = "Stem Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        axis.title.x = element_text(size = 10),
        axis.title.y = element_text(size = 10),
        legend.title = element_text(size = 10),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Phoma sp.313" = "lightgreen"))


p  


# Sample data structure
# data <- data.frame(
#   species = rep(c("Species1", "Species2", "Species3"), each = 10),
#   leaf_length = rnorm(30, mean = 5, sd = 2),
#   group = rep(c("Control", "Test"), each = 15),
#   type_of_microbe = rep(c("Bacteria", "Fungi"), each = 15)
# )

# Load necessary libraries
library(dplyr)

# Generate summary statistics
summary_data <- Data %>%
  group_by(soil_space, species, microbe_) %>%
  summarise(
    mean_stem_length = mean(stem_length),
    se_leaf_length = sd(stem_length_) / sqrt(n()),
    .groups = 'drop'
  )

# Print the summary table
print(summary_data)
# Export the summary table to a CSV file
write.csv(summary_data, "summary_table.csv", row.names = FALSE)
```

###
Confrontation trial stats Root Length


#Uploading packages and Data set. 

Data<-read.csv("Rconfrontation_data.csv", header=T)
#Creating a subset for the control 
control_subset <- subset(Data, species == "control")
Bacteria species and Fungal species, first testing for normality and then doing ANOVA or WILCOXON (if normality is not met)

control_subset$log_root_length <- as.numeric(control_subset$log_root_length)
###Using Log transformed data for ANOVA analysis 

#control
library("ggpubr")
## Loading required package: ggplot2
# Draw the Q-Q plot
ggqqplot(control_subset$log_root_length, 
         title = "Q-Q Plot of log_root_length for Control Subset",
         xlab = "Theoretical Quantiles",
         ylab = "Sample Quantiles")


control_subset$log_root_length <- as.numeric(control_subset$log_root_length)



#p value needs to be higher than 0.05 to assume normality
shapiro.test(control_subset$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  control_subset$log_root_length
## W = 0.9742, p-value = 0.2931
#p-value = 0.2931



##Does meet normality assumptions so we will be testing normality for each species and test the appropriate test, One way ANOVA for species that fulfill normality, and WILCOXON for species that do not fulfill normality. 
library(dplyr)
## 
## Attaching package: 'dplyr'
## The following objects are masked from 'package:stats':
## 
##     filter, lag
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
head(Data)
 
 
microbe_
<chr>
soil_space
<chr>
trial
<int>
plate
<int>
seed_replicate
<int>
species
<chr>
species_ID
<chr>
root_length_
<dbl>
1	fungi	inter	1	1	1	Phoma_sp.	301ci57	34.661	
2	fungi	inter	1	1	2	Phoma_sp.	301ci57	26.586	
3	fungi	inter	1	1	3	Phoma_sp.	301ci57	27.990	
4	fungi	inter	1	1	4	Phoma_sp.	301ci57	23.032	
5	fungi	inter	1	1	5	Phoma_sp.	301ci57	24.731	
6	fungi	inter	1	1	6	Phoma_sp.	301ci57	23.193	
6 rows | 1-9 of 16 columns
# Summary statistics for each species
summary_stats <- Data %>%
  group_by(species) %>%
  summarise(
    mean_length = mean(root_length_),
    sd_length = sd(root_length_),
    n = n()
  )

print(summary_stats)
## # A tibble: 22 × 4
##    species                mean_length sd_length     n
##    <chr>                        <dbl>     <dbl> <int>
##  1 Acidovorax_sp                 19.6      7.26    54
##  2 Alternaria_alternata          22.3      6.85    54
##  3 Anthrobacter_agilis           17.7      9.28    54
##  4 Anuerinibacillus_sp           22.4      8.98    54
##  5 Bacillus_cerus                22.4      8.98    54
##  6 Bacillus_mycodies             27.3     12.5     54
##  7 Bacillus_paramycoides         14.7      4.76    54
##  8 Bacillus_proteolyti           24.8      7.67    54
##  9 Bacillus_thuringiensis        28.4     10.0     54
## 10 Cladosporium_sp.              15.8      5.51    54
## # ℹ 12 more rows
# Facet grid plot for Root Length across microbial species, faceted by type of microbe
ggplot(Data, aes(x = species, y = root_length_)) +
  geom_boxplot(aes(fill = species)) +
  facet_wrap(~microbe_) +
  theme_minimal() +
  labs(title = "Root Length Across Microbial Species",
       x = "Microbial Species",
       y = "Root Length (mm)")


##Need to spread out x axis for species names

# Boxplot to compare Root Lengths with colors
ggplot(Data, aes(x = soil_space, y = root_length_, fill = soil_space)) +
  geom_boxplot() +
  theme_minimal() +
  labs(
    title ="Comparison of Root Length Between Test Species and Control",
    x = "Soil Space",
    y = "Root Length (mm)"
  ) +
  scale_fill_manual(values = c("inter" = "skyblue", "under" = "salmon", "control" = "purple"))+
  theme(
    plot.title = element_text(size = 10) )


# Boxplot to compare Root Lengths with colors
ggplot(Data, aes(x = microbe_, y = root_length_, fill = microbe_)) +
  geom_boxplot() +
  theme_minimal() +
  labs(
    title ="Comparison of Root Length Between Test Species and Control",
    x = "Microbe type",
    y = "Root Length (mm)"
  ) +
  scale_fill_manual(values = c("inter" = "orange", "bacteria" = "pink", "fungi" = "brown"))+
  theme(
    plot.title = element_text(size = 10) )


# Cleaning up data, converting it to numeric and cleaning up NAs 
summary(Data$log_root_length)
##    Length     Class      Mode 
##      1242 character character
Data$log_root_length <- as.numeric(Data$log_root_length)
## Warning: NAs introduced by coercion
sum(is.na(Data$log_root_length))
## [1] 2
Data_clean <- Data %>% filter(!is.na(log_root_length))
Data$log_root_length[is.na(Data$log_root_length)] <- mean(Data$log_root_length, na.rm = TRUE)

summary(Data$log_root_length)
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.4011  1.1741  1.3061  1.3038  1.4423  1.8155
# Perform ANOVA to compare means among soil space
anova_result <- aov(log_root_length  ~ soil_space, data = Data)
summary(anova_result)
##               Df Sum Sq Mean Sq F value   Pr(>F)    
## soil_space     2   1.10  0.5523   15.18 3.08e-07 ***
## Residuals   1239  45.09  0.0364                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#Conclusion:
#The ANOVA results show that the soil_space factor has a statistically significant effect on the log_root_length  variable (p = 3.08e-07). This suggests that the means of log_root_length  are significantly different across the levels of soil_space.


# If ANOVA is significant, perform post-hoc Tukey's HSD test
tukey_result <- TukeyHSD(anova_result)
print(tukey_result)
##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = log_root_length ~ soil_space, data = Data)
## 
## $soil_space
##                      diff         lwr         upr     p adj
## inter-control  0.08998880  0.02658716  0.15339044 0.0025676
## under-control  0.03514253 -0.02875413  0.09903919 0.4007444
## under-inter   -0.05484627 -0.08093384 -0.02875871 0.0000027
# Visualize Tukey's HSD test results
plot(tukey_result)


"Acidovorax_sp."
## [1] "Acidovorax_sp."
#Creating a Acidovorax_sp subset from data 
Acidovorax_sp.data <- subset(Data, species == "Acidovorax_sp")
summary(Acidovorax_sp.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length
##  Length:54          Length:54          Min.   : 7.464   Min.   :0.873  
##  Class :character   Class :character   1st Qu.:14.636   1st Qu.:1.165  
##  Mode  :character   Mode  :character   Median :18.851   Median :1.275  
##                                        Mean   :19.611   Mean   :1.262  
##                                        3rd Qu.:24.459   3rd Qu.:1.388  
##                                        Max.   :38.849   Max.   :1.589  
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.329   Min.   :0.5222   Min.   :4.000   Min.   :1.000  
##  1st Qu.:4.429   1st Qu.:0.6463   1st Qu.:4.250   1st Qu.:3.000  
##  Median :5.222   Median :0.7178   Median :6.000   Median :4.000  
##  Mean   :5.638   Mean   :0.7342   Mean   :5.519   Mean   :4.389  
##  3rd Qu.:6.857   3rd Qu.:0.8357   3rd Qu.:6.000   3rd Qu.:6.000  
##  Max.   :9.300   Max.   :0.9685   Max.   :8.000   Max.   :9.000  
##   stem_length       log_stem     
##  Min.   :1.583   Min.   :0.1995  
##  1st Qu.:2.503   1st Qu.:0.3985  
##  Median :2.904   Median :0.4630  
##  Mean   :2.902   Mean   :0.4526  
##  3rd Qu.:3.324   3rd Qu.:0.5217  
##  Max.   :4.916   Max.   :0.6916
ggqqplot(Acidovorax_sp.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(control_subset$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  control_subset$log_root_length
## W = 0.9742, p-value = 0.2931
#p value needs to be higher than 0.05 to assume normality
#p-value = 0.2931, fufrills normality assumtions

anova_result <- aov(log_root_length  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Acidovorax_sp.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects

summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.02966 0.02966               
## 
## Error: trial:plate
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.02232 0.02232               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value Pr(>F)
## species     1 0.0117 0.01173   0.438  0.509
## Residuals 104 2.7820 0.02675
#Pvalue = 0.509,no significant difference.
"Anthrobacter_agilis"
## [1] "Anthrobacter_agilis"
Anthrobacter_agilis.data <- subset(Data, species == "Anthrobacter_agilis")
summary(Anthrobacter_agilis.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length 
##  Length:54          Length:54          Min.   : 0.00   Min.   :0.5521  
##  Class :character   Class :character   1st Qu.:11.50   1st Qu.:1.0707  
##  Mode  :character   Mode  :character   Median :15.35   Median :1.1871  
##                                        Mean   :17.66   Mean   :1.2050  
##                                        3rd Qu.:22.93   3rd Qu.:1.3603  
##                                        Max.   :47.28   Max.   :1.6747  
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.341   Min.   :0.5239   Min.   :4.000   Min.   :0.000  
##  1st Qu.:4.083   1st Qu.:0.6110   1st Qu.:4.000   1st Qu.:1.000  
##  Median :4.454   Median :0.6487   Median :6.000   Median :2.000  
##  Mean   :4.562   Mean   :0.6543   Mean   :5.333   Mean   :2.037  
##  3rd Qu.:5.106   3rd Qu.:0.7080   3rd Qu.:6.000   3rd Qu.:3.000  
##  Max.   :6.296   Max.   :0.7991   Max.   :6.000   Max.   :6.000  
##   stem_length       log_stem     
##  Min.   :1.476   Min.   :0.1691  
##  1st Qu.:2.262   1st Qu.:0.3544  
##  Median :2.522   Median :0.4017  
##  Mean   :2.585   Mean   :0.4040  
##  3rd Qu.:2.781   3rd Qu.:0.4442  
##  Max.   :4.273   Max.   :0.6307
ggqqplot(Anthrobacter_agilis.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Anthrobacter_agilis.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Anthrobacter_agilis.data$log_root_length
## W = 0.98533, p-value = 0.7468
#p=0.7468, furfills normality assumtions 

anova_result <- aov(log_root_length  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Anthrobacter_agilis.data ))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.4231  0.4231               
## 
## Error: trial:plate
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.003942 0.003942               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value Pr(>F)
## species     1  0.036 0.03602   1.093  0.298
## Residuals 104  3.428 0.03296
#p value=0.298, Root Length in this species is not significantly different than control, 
#"Anuerinibacillus_sp."

#Create a subset 
Anuerinibacillus_sp.data <- subset(Data, species == "Anuerinibacillus_sp")
ggqqplot(Anuerinibacillus_sp.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Anuerinibacillus_sp.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Anuerinibacillus_sp.data$log_root_length
## W = 0.93314, p-value = 0.004873
#p=0.004873 Does not furfill normality assumtions 

wilcox_test <- wilcox.test(log_root_length  ~ species, data = rbind(control_subset, Anuerinibacillus_sp.data))
print(wilcox_test)
## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  log_root_length by species
## W = 1848, p-value = 0.0167
## alternative hypothesis: true location shift is not equal to 0
#p-value= 0.0167, suggests significantly different.



#Plot
x<-(control_subset$root_length_)
y<-(Anuerinibacillus_sp.data$root_length_)

data <- data.frame(
  Group = rep(c("Control", "Anuerinibacillus_s"), each = length(x)),
  Value = c(x, y)
)
# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Anuerinibacillus_s VS Control Root Length",
       x = "Group",
       y = "Root Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Anuerinibacillus_s" = "lightgreen"))

p 


"Bacillus_albus"
## [1] "Bacillus_albus"
#Create a subset 
Bacillus_albus.data <- subset(Data, species == "bacillus_albus")
summary(Bacillus_albus.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length 
##  Length:54          Length:54          Min.   : 7.48   Min.   :0.8739  
##  Class :character   Class :character   1st Qu.:16.75   1st Qu.:1.2239  
##  Mode  :character   Mode  :character   Median :20.48   Median :1.3112  
##                                        Mean   :21.94   Mean   :1.3105  
##                                        3rd Qu.:28.02   3rd Qu.:1.4474  
##                                        Max.   :43.76   Max.   :1.6411  
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.375   Min.   :0.5283   Min.   :4.000   Min.   :2.000  
##  1st Qu.:4.827   1st Qu.:0.6837   1st Qu.:4.500   1st Qu.:4.000  
##  Median :5.281   Median :0.7227   Median :6.000   Median :5.000  
##  Mean   :5.338   Mean   :0.7219   Mean   :5.481   Mean   :5.148  
##  3rd Qu.:5.948   3rd Qu.:0.7744   3rd Qu.:6.000   3rd Qu.:6.000  
##  Max.   :7.104   Max.   :0.8515   Max.   :6.000   Max.   :9.000  
##   stem_length       log_stem     
##  Min.   :1.511   Min.   :0.1793  
##  1st Qu.:2.144   1st Qu.:0.3312  
##  Median :2.372   Median :0.3751  
##  Mean   :2.416   Mean   :0.3755  
##  3rd Qu.:2.721   3rd Qu.:0.4347  
##  Max.   :3.757   Max.   :0.5748
ggqqplot(Bacillus_albus.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Bacillus_albus.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Bacillus_albus.data$log_root_length
## W = 0.96007, p-value = 0.0694
# p-value = 0.0694, fulfills normality assumptions 


anova_result <- aov(log_root_length  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Bacillus_albus.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df    Sum Sq   Mean Sq F value Pr(>F)
## Residuals  1 3.988e-07 3.988e-07               
## 
## Error: trial:plate
##           Df    Sum Sq   Mean Sq F value Pr(>F)
## Residuals  1 9.052e-05 9.052e-05               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value Pr(>F)  
## species     1 0.1283 0.12831   4.586 0.0346 *
## Residuals 104 2.9098 0.02798                 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# p-value= 0.0346, suggesting significant difference of Root Length measurements among this species and control 



#Plot ##Attempting to debug 
x<-(control_subset$root_length_)
y<-(Bacillus_albus.data$root_length_)

data <- data.frame(
  Group = rep(c("Control", "Bacillus_albus"), each = length(x)),
  Value = c(x, y)
)
# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Bacillus_albus VS Control Root Length",
       x = "Group",
       y = "Root Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Bacillus_albus" = "lightgreen"))

p 


"Bacillus_cerus"
## [1] "Bacillus_cerus"
#Create a subset 
Bacillus_cerus.data <- subset(Data, species == "Bacillus_cerus")
summary(Bacillus_cerus.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length 
##  Length:54          Length:54          Min.   : 4.737   Min.   :0.6755  
##  Class :character   Class :character   1st Qu.:15.139   1st Qu.:1.1801  
##  Mode  :character   Mode  :character   Median :22.985   Median :1.3614  
##                                        Mean   :22.380   Mean   :1.3079  
##                                        3rd Qu.:27.363   3rd Qu.:1.4372  
##                                        Max.   :41.627   Max.   :1.6194  
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :1.361   Min.   :0.1339   Min.   :4.000   Min.   :2.000  
##  1st Qu.:2.778   1st Qu.:0.4438   1st Qu.:5.000   1st Qu.:4.000  
##  Median :4.443   Median :0.6476   Median :6.000   Median :5.000  
##  Mean   :4.189   Mean   :0.5836   Mean   :5.463   Mean   :4.778  
##  3rd Qu.:5.395   3rd Qu.:0.7319   3rd Qu.:6.000   3rd Qu.:6.000  
##  Max.   :7.622   Max.   :0.8820   Max.   :6.000   Max.   :9.000  
##   stem_length       log_stem      
##  Min.   :1.235   Min.   :0.09167  
##  1st Qu.:2.248   1st Qu.:0.35172  
##  Median :2.503   Median :0.39855  
##  Mean   :2.568   Mean   :0.39978  
##  3rd Qu.:2.938   3rd Qu.:0.46808  
##  Max.   :3.789   Max.   :0.57852
ggqqplot(Bacillus_cerus.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Bacillus_cerus.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Bacillus_cerus.data$log_root_length
## W = 0.93314, p-value = 0.004873
# p-value= p-value = 0.004873 , does not furfills normality assumtions.


# Perform the Wilcoxon Rank Sum Test
wilcox_test <- wilcox.test(log_root_length  ~ species, data = rbind(control_subset, Bacillus_cerus.data))
print(wilcox_test)
## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  log_root_length by species
## W = 1848, p-value = 0.0167
## alternative hypothesis: true location shift is not equal to 0
#p-value =0.0167, significantly different, fail to reject the null hypothesis that there are no differences among Bacillus cerus Root Length versus the control. 

#Plot
x<-(control_subset$root_length_)
y<-(Bacillus_cerus.data$root_length_)

data <- data.frame(
  Group = rep(c("Control", "Bacillus_cerus"), each = length(x)),
  Value = c(x, y)
)
# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Bacillus_cerus VS Control Root Length",
       x = "Group",
       y = "Root Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Bacillus_albus" = "lightgreen"))

p 


"Bacillus_mycodies"
## [1] "Bacillus_mycodies"
#Create a subset 
Bacillus_mycodies.data <- subset(Data, species == "Bacillus_mycodies")
summary(Bacillus_mycodies.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length 
##  Length:54          Length:54          Min.   : 9.423   Min.   :0.9742  
##  Class :character   Class :character   1st Qu.:17.397   1st Qu.:1.2405  
##  Mode  :character   Mode  :character   Median :26.843   Median :1.4288  
##                                        Mean   :27.347   Mean   :1.3928  
##                                        3rd Qu.:32.766   3rd Qu.:1.5154  
##                                        Max.   :64.685   Max.   :1.8108  
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.624   Min.   :0.5592   Min.   :4.000   Min.   :1.000  
##  1st Qu.:4.407   1st Qu.:0.6441   1st Qu.:6.000   1st Qu.:3.000  
##  Median :4.673   Median :0.6696   Median :6.000   Median :4.000  
##  Mean   :4.724   Mean   :0.6714   Mean   :5.704   Mean   :3.981  
##  3rd Qu.:5.015   3rd Qu.:0.7002   3rd Qu.:6.000   3rd Qu.:5.000  
##  Max.   :6.074   Max.   :0.7834   Max.   :6.000   Max.   :8.000  
##   stem_length       log_stem     
##  Min.   :2.022   Min.   :0.3058  
##  1st Qu.:2.781   1st Qu.:0.4442  
##  Median :3.188   Median :0.5036  
##  Mean   :3.249   Mean   :0.5026  
##  3rd Qu.:3.715   3rd Qu.:0.5699  
##  Max.   :5.402   Max.   :0.7326
ggqqplot(Bacillus_mycodies.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Bacillus_mycodies.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Bacillus_mycodies.data$log_root_length
## W = 0.9828, p-value = 0.6268
#furfills normality assumtions, p-value = 0.6268 


anova_result <- aov(log_root_length  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Bacillus_mycodies.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.09578 0.09578               
## 
## Error: trial:plate
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.02717 0.02717               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1  0.618  0.6176   19.09 2.96e-05 ***
## Residuals 104  3.366  0.0324                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# p-value=2.96e-05, suggesting significantly different Root Lengths from control. 


#Plot
x<-(control_subset$root_length_)
y<-(Bacillus_mycodies.data$root_length_)

data <- data.frame(
  Group = rep(c("Control", "Bacillus_mycodies"), each = length(x)),
  Value = c(x, y)
)
# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Bacillus_mycodies VS Control Root Length",
       x = "Group",
       y = "Root Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Bacillus_mycodies" = "lightgreen"))

p 


"Bacillus paramycoides" 
## [1] "Bacillus paramycoides"
#Create a subset 
Bacillus_paramycoides.data <- subset(Data, species == "Bacillus_paramycoides")
summary(Bacillus_paramycoides.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length 
##  Length:54          Length:54          Min.   : 6.373   Min.   :0.8043  
##  Class :character   Class :character   1st Qu.:11.190   1st Qu.:1.0488  
##  Mode  :character   Mode  :character   Median :14.354   Median :1.1569  
##                                        Mean   :14.733   Mean   :1.1471  
##                                        3rd Qu.:16.812   3rd Qu.:1.2256  
##                                        Max.   :29.675   Max.   :1.4724  
##  leaf_average_     log_leaf_avg      leaf_count    lateral_roots   
##  Min.   : 3.818   Min.   :0.5818   Min.   :2.000   Min.   : 1.000  
##  1st Qu.: 4.654   1st Qu.:0.6678   1st Qu.:4.000   1st Qu.: 1.250  
##  Median : 5.167   Median :0.7133   Median :6.000   Median : 2.000  
##  Mean   : 5.678   Mean   :0.7413   Mean   :5.222   Mean   : 2.741  
##  3rd Qu.: 6.359   3rd Qu.:0.8033   3rd Qu.:6.000   3rd Qu.: 3.000  
##  Max.   :11.180   Max.   :1.0484   Max.   :6.000   Max.   :12.000  
##   stem_length       log_stem     
##  Min.   :1.372   Min.   :0.1374  
##  1st Qu.:2.316   1st Qu.:0.3648  
##  Median :2.650   Median :0.4232  
##  Mean   :2.593   Mean   :0.4042  
##  3rd Qu.:2.864   3rd Qu.:0.4569  
##  Max.   :3.801   Max.   :0.5799
ggqqplot(Bacillus_paramycoides.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Bacillus_paramycoides.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Bacillus_paramycoides.data$log_root_length
## W = 0.99224, p-value = 0.9788
#p-value = 0.9788, does furfill normality assumtions 

anova_result <- aov(log_root_length  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Bacillus_paramycoides.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.01775 0.01775               
## 
## Error: trial:plate
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.01724 0.01724               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value Pr(>F)   
## species     1  0.241 0.24099   10.77 0.0014 **
## Residuals 104  2.327 0.02237                  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value= 0.0014

#Plot
x<-(control_subset$root_length_)
y<-(Bacillus_paramycoides.data$root_length_)

data <- data.frame(
  Group = rep(c("Control", "Bacillus_paramycoides"), each = length(x)),
  Value = c(x, y)
)
# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Bacillus_paramycoides VS Control Root Length",
       x = "Group",
       y = "Root Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Bacillus_paramycoides" = "lightgreen"))

p 


"Bacillus proteolyti"
## [1] "Bacillus proteolyti"
Bacillus_proteolyti.data <- subset(Data, species == "Bacillus_proteolyti")
summary(Bacillus_proteolyti.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##                                                                              
##    species           species_ID         root_length_   log_root_length
##  Length:54          Length:54          Min.   :10.29   Min.   :1.012  
##  Class :character   Class :character   1st Qu.:19.15   1st Qu.:1.282  
##  Mode  :character   Mode  :character   Median :24.42   Median :1.388  
##                                        Mean   :24.75   Mean   :1.373  
##                                        3rd Qu.:29.24   3rd Qu.:1.466  
##                                        Max.   :45.16   Max.   :1.655  
##                                                                       
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.535   Min.   :0.5485   Min.   :4.000   Min.   : 1.00  
##  1st Qu.:4.322   1st Qu.:0.6357   1st Qu.:4.000   1st Qu.: 3.00  
##  Median :4.793   Median :0.6806   Median :5.500   Median : 4.00  
##  Mean   :4.979   Mean   :0.6901   Mean   :5.056   Mean   : 4.66  
##  3rd Qu.:5.603   3rd Qu.:0.7484   3rd Qu.:6.000   3rd Qu.: 6.00  
##  Max.   :7.136   Max.   :0.8534   Max.   :6.000   Max.   :17.00  
##                                                   NA's   :1      
##   stem_length       log_stem     
##  Min.   :2.010   Min.   :0.3032  
##  1st Qu.:2.516   1st Qu.:0.4007  
##  Median :2.803   Median :0.4476  
##  Mean   :2.952   Mean   :0.4609  
##  3rd Qu.:3.266   3rd Qu.:0.5139  
##  Max.   :5.777   Max.   :0.7617  
## 
ggqqplot(Bacillus_proteolyti.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Bacillus_proteolyti.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Bacillus_proteolyti.data$log_root_length
## W = 0.98735, p-value = 0.837
#p-value = 0.837, furfills normality assumtions 


anova_result <- aov(log_root_length  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Bacillus_proteolyti.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.01689 0.01689               
## 
## Error: trial:plate
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.001305 0.001305               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1 0.4644  0.4644   20.45 1.62e-05 ***
## Residuals 104 2.3613  0.0227                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# p-value=1.62e-05 , suggesting statistically significant. 

#Plot
x<-(control_subset$root_length_)
y<-(Bacillus_proteolyti.data$root_length_)

data <- data.frame(
  Group = rep(c("Control", "Bacillus_proteolyti"), each = length(x)),
  Value = c(x, y)
)
# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Bacillus_proteolyti VS Control Root Length",
       x = "Group",
       y = "Root Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Bacillus_proteolyti" = "lightgreen"))

p 


"Bacillus thuringiensis"
## [1] "Bacillus thuringiensis"
Bacillus_thuringiensis.data <- subset(Data, species == "Bacillus_thuringiensis")
summary(Bacillus_thuringiensis.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length
##  Length:54          Length:54          Min.   :12.55   Min.   :1.099  
##  Class :character   Class :character   1st Qu.:19.62   1st Qu.:1.293  
##  Mode  :character   Mode  :character   Median :26.49   Median :1.423  
##                                        Mean   :28.45   Mean   :1.427  
##                                        3rd Qu.:36.23   3rd Qu.:1.559  
##                                        Max.   :52.01   Max.   :1.716  
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :4.254   Min.   :0.6288   Min.   :4.000   Min.   :2.000  
##  1st Qu.:5.048   1st Qu.:0.7031   1st Qu.:6.000   1st Qu.:4.000  
##  Median :5.463   Median :0.7374   Median :6.000   Median :5.000  
##  Mean   :5.694   Mean   :0.7504   Mean   :5.944   Mean   :5.407  
##  3rd Qu.:6.128   3rd Qu.:0.7873   3rd Qu.:6.000   3rd Qu.:7.750  
##  Max.   :8.762   Max.   :0.9426   Max.   :8.000   Max.   :9.000  
##   stem_length       log_stem      
##  Min.   :1.255   Min.   :0.09864  
##  1st Qu.:2.221   1st Qu.:0.34654  
##  Median :2.516   Median :0.40071  
##  Mean   :2.613   Mean   :0.40581  
##  3rd Qu.:3.065   3rd Qu.:0.48643  
##  Max.   :4.109   Max.   :0.61374
ggqqplot(Bacillus_thuringiensis.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Bacillus_thuringiensis.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Bacillus_thuringiensis.data$log_root_length
## W = 0.971, p-value = 0.2132
#p-value = 0.2132,does fulfill normality assumptions 

anova_result <- aov(log_root_length  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Bacillus_thuringiensis.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.08089 0.08089               
## 
## Error: trial:plate
##           Df Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.0304  0.0304               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1 0.9311  0.9311    38.2 1.27e-08 ***
## Residuals 104 2.5349  0.0244                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value =1.27e-08, suggesting significantly different. 

#Plot
x<-(control_subset$root_length_)
y<-(Bacillus_thuringiensis.data$root_length_)

data <- data.frame(
  Group = rep(c("Control", "Bacillus_thuringiensis"), each = length(x)),
  Value = c(x, y)
)

# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
 labs(title = "Bacillus_thuringiensis VS Control Root Length Average",
       x = "Group",
       y = "Root Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Bacillus_thuringiensis" = "lightgreen"))

p 


Micobacterium_sp.data <- subset(Data, species == "Micobacterium_sp")
summary(Micobacterium_sp.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##                                                                              
##    species           species_ID         root_length_    log_root_length 
##  Length:54          Length:54          Min.   : 9.051   Min.   :0.9567  
##  Class :character   Class :character   1st Qu.:14.818   1st Qu.:1.1708  
##  Mode  :character   Mode  :character   Median :17.951   Median :1.2541  
##                                        Mean   :19.817   Mean   :1.2669  
##                                        3rd Qu.:23.566   3rd Qu.:1.3723  
##                                        Max.   :45.558   Max.   :1.6586  
##                                                                         
##  leaf_average_    log_leaf_avg      leaf_count   lateral_roots  
##  Min.   :3.166   Min.   :0.5005   Min.   :4.00   Min.   :3.000  
##  1st Qu.:3.942   1st Qu.:0.5958   1st Qu.:6.00   1st Qu.:4.250  
##  Median :4.580   Median :0.6609   Median :6.00   Median :5.500  
##  Mean   :4.599   Mean   :0.6559   Mean   :5.83   Mean   :5.519  
##  3rd Qu.:5.079   3rd Qu.:0.7058   3rd Qu.:6.00   3rd Qu.:6.000  
##  Max.   :6.821   Max.   :0.8338   Max.   :6.00   Max.   :9.000  
##                                   NA's   :1                     
##   stem_length       log_stem     
##  Min.   :1.396   Min.   :0.1449  
##  1st Qu.:2.049   1st Qu.:0.3114  
##  Median :2.394   Median :0.3792  
##  Mean   :2.465   Mean   :0.3818  
##  3rd Qu.:2.708   3rd Qu.:0.4326  
##  Max.   :3.739   Max.   :0.5728  
## 
ggqqplot(Micobacterium_sp.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Micobacterium_sp.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Micobacterium_sp.data$log_root_length
## W = 0.98202, p-value = 0.5908
#p-value = 0.5908,furfills normality assumtions 


anova_result <- aov(log_root_length  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Micobacterium_sp.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.03347 0.03347               
## 
## Error: trial:plate
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.03365 0.03365               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value Pr(>F)
## species     1 0.0174 0.01738   0.677  0.412
## Residuals 104 2.6687 0.02566
#p-value=0.412, not statistically significant.
"Microbacterium_oxydans"
## [1] "Microbacterium_oxydans"
Microbacterium_oxydans.data <- subset(Data, species == "Microbacterium_oxydans")
summary(Microbacterium_oxydans.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length 
##  Length:54          Length:54          Min.   : 2.518   Min.   :0.4011  
##  Class :character   Class :character   1st Qu.:12.134   1st Qu.:1.0839  
##  Mode  :character   Mode  :character   Median :19.643   Median :1.2931  
##                                        Mean   :21.879   Mean   :1.2689  
##                                        3rd Qu.:29.620   3rd Qu.:1.4715  
##                                        Max.   :56.961   Max.   :1.7556  
##  leaf_average_    log_leaf_avg      leaf_count     lateral_roots   
##  Min.   :3.574   Min.   :0.5531   Min.   : 4.000   Min.   : 0.000  
##  1st Qu.:4.504   1st Qu.:0.6535   1st Qu.: 4.000   1st Qu.: 3.250  
##  Median :4.878   Median :0.6882   Median : 5.000   Median : 5.000  
##  Mean   :5.136   Mean   :0.7052   Mean   : 5.926   Mean   : 5.407  
##  3rd Qu.:5.774   3rd Qu.:0.7615   3rd Qu.: 6.000   3rd Qu.: 6.000  
##  Max.   :7.236   Max.   :0.8595   Max.   :55.000   Max.   :65.000  
##   stem_length       log_stem     
##  Min.   :1.689   Min.   :0.2276  
##  1st Qu.:2.653   1st Qu.:0.4237  
##  Median :3.220   Median :0.5078  
##  Mean   :3.224   Mean   :0.4980  
##  3rd Qu.:3.720   3rd Qu.:0.5705  
##  Max.   :4.986   Max.   :0.6978
ggqqplot(Microbacterium_oxydans.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Microbacterium_oxydans.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Microbacterium_oxydans.data$log_root_length
## W = 0.96948, p-value = 0.1828
#p-value = 0.1862 furfills normality assumtions 


anova_result <- aov(log_root_length  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Microbacterium_oxydans.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.0057  0.0057               
## 
## Error: trial:plate
##           Df Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.3052  0.3052               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value Pr(>F)
## species     1  0.020 0.02022   0.438   0.51
## Residuals 104  4.804 0.04619
#p-value = 0.51 ,not significantly different 
"Paenibacillus_sp."
## [1] "Paenibacillus_sp."
Paenibacillus_sp.data <- subset(Data, species == "Paenibacillus_sp")
summary(Paenibacillus_sp.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length
##  Length:54          Length:54          Min.   :11.91   Min.   :1.076  
##  Class :character   Class :character   1st Qu.:19.66   1st Qu.:1.294  
##  Mode  :character   Mode  :character   Median :24.38   Median :1.387  
##                                        Mean   :24.35   Mean   :1.370  
##                                        3rd Qu.:27.73   3rd Qu.:1.443  
##                                        Max.   :41.75   Max.   :1.621  
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :2.244   Min.   :0.3511   Min.   :4.000   Min.   :2.000  
##  1st Qu.:4.978   1st Qu.:0.6970   1st Qu.:4.000   1st Qu.:4.000  
##  Median :5.403   Median :0.7327   Median :4.000   Median :5.000  
##  Mean   :5.339   Mean   :0.7204   Mean   :4.926   Mean   :5.019  
##  3rd Qu.:5.808   3rd Qu.:0.7640   3rd Qu.:6.000   3rd Qu.:6.000  
##  Max.   :7.251   Max.   :0.8604   Max.   :6.000   Max.   :9.000  
##   stem_length       log_stem     
##  Min.   :1.545   Min.   :0.1889  
##  1st Qu.:2.329   1st Qu.:0.3672  
##  Median :2.651   Median :0.4235  
##  Mean   :2.790   Mean   :0.4338  
##  3rd Qu.:3.162   3rd Qu.:0.5000  
##  Max.   :4.483   Max.   :0.6516
ggqqplot(Paenibacillus_sp.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Paenibacillus_sp.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Paenibacillus_sp.data$log_root_length
## W = 0.98333, p-value = 0.652
#p-value = 0.652, does fulfill normality assumptions 

anova_result <- aov(log_root_length  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Paenibacillus_sp.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.001923 0.001923               
## 
## Error: trial:plate
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.005234 0.005234               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1 0.4429  0.4429   21.28 1.13e-05 ***
## Residuals 104 2.1642  0.0208                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value = 1.13e-05 , suggesting significantly different. 

#Plot
x<-(control_subset$root_length_)
y<-(Paenibacillus_sp.data$root_length_)

data <- data.frame(
  Group = rep(c("Control", "Paenibacillus_sp"), each = length(x)),
  Value = c(x, y)
)

# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Paenibacillus_sp VS Control Root Length",
       x = "Group",
       y = "Root Length mm") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Paenibacillus_sp" = "lightgreen"))

p 


"Alternaria_alternata"
## [1] "Alternaria_alternata"
Alternaria_alternata.data <- subset(Data, species == "Alternaria_alternata")
summary(Alternaria_alternata.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length
##  Length:54          Length:54          Min.   : 7.944   Min.   :0.900  
##  Class :character   Class :character   1st Qu.:18.028   1st Qu.:1.256  
##  Mode  :character   Mode  :character   Median :20.572   Median :1.313  
##                                        Mean   :22.258   Mean   :1.325  
##                                        3rd Qu.:26.841   3rd Qu.:1.429  
##                                        Max.   :38.574   Max.   :1.586  
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :2.759   Min.   :0.4408   Min.   :4.000   Min.   :2.000  
##  1st Qu.:4.460   1st Qu.:0.6493   1st Qu.:6.000   1st Qu.:3.000  
##  Median :5.208   Median :0.7167   Median :6.000   Median :4.000  
##  Mean   :5.583   Mean   :0.7329   Mean   :5.907   Mean   :4.167  
##  3rd Qu.:6.651   3rd Qu.:0.8229   3rd Qu.:6.000   3rd Qu.:5.750  
##  Max.   :8.947   Max.   :0.9517   Max.   :8.000   Max.   :7.000  
##   stem_length       log_stem     
##  Min.   :1.445   Min.   :0.1599  
##  1st Qu.:1.940   1st Qu.:0.2877  
##  Median :2.212   Median :0.3447  
##  Mean   :2.352   Mean   :0.3596  
##  3rd Qu.:2.637   3rd Qu.:0.4211  
##  Max.   :4.179   Max.   :0.6211
ggqqplot(Alternaria_alternata.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Alternaria_alternata.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Alternaria_alternata.data$log_root_length
## W = 0.95998, p-value = 0.06875
#p-value =  0.06875, fulfills normality assumptions 


anova_result <- aov(log_root_length  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Alternaria_alternata.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.02662 0.02662               
## 
## Error: trial:plate
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.02529 0.02529               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value  Pr(>F)   
## species     1 0.1896 0.18958   8.107 0.00531 **
## Residuals 104 2.4319 0.02338                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# p-value= 0.00531, significantly different. 

#plot
x<-(control_subset$root_length_)
y<-(Alternaria_alternata.data$root_length_)

data <- data.frame(
  Group = rep(c("Control", "Alternaria_alternata"), each = length(x)),
  Value = c(x, y)
)

# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Alternaria_alternata VS Control Root Length",
       x = "Group",
       y = "Root Length mm") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Alternaria_alternata" = "lightgreen"))

p 


"Cladosporium_sp."
## [1] "Cladosporium_sp."
Cladosporium_sp.data <- subset(Data, species == "Cladosporium_sp.")
summary(Cladosporium_sp.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length 
##  Length:54          Length:54          Min.   : 4.253   Min.   :0.6287  
##  Class :character   Class :character   1st Qu.:11.737   1st Qu.:1.0696  
##  Mode  :character   Mode  :character   Median :15.358   Median :1.1863  
##                                        Mean   :15.841   Mean   :1.1708  
##                                        3rd Qu.:19.161   3rd Qu.:1.2824  
##                                        Max.   :29.520   Max.   :1.4701  
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.115   Min.   :0.4935   Min.   :4.000   Min.   :2.000  
##  1st Qu.:4.125   1st Qu.:0.6154   1st Qu.:4.000   1st Qu.:2.000  
##  Median :4.651   Median :0.6675   Median :4.000   Median :2.000  
##  Mean   :4.675   Mean   :0.6628   Mean   :4.704   Mean   :2.815  
##  3rd Qu.:5.243   3rd Qu.:0.7195   3rd Qu.:6.000   3rd Qu.:4.000  
##  Max.   :6.526   Max.   :0.8146   Max.   :6.000   Max.   :6.000  
##   stem_length       log_stem      
##  Min.   :0.317   Min.   :-0.4989  
##  1st Qu.:2.243   1st Qu.: 0.3508  
##  Median :2.653   Median : 0.4237  
##  Mean   :2.670   Mean   : 0.4041  
##  3rd Qu.:3.075   3rd Qu.: 0.4879  
##  Max.   :5.808   Max.   : 0.7640
ggqqplot(Cladosporium_sp.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Cladosporium_sp.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Cladosporium_sp.data$log_root_length
## W = 0.96002, p-value = 0.06906
#p-value = 0.06906, does  furfills normality assumtions 

anova_result <- aov(log_root_length  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Cladosporium_sp.data))
 #rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##            Df   Sum Sq  Mean Sq
## soil_space  1 0.005123 0.005123
## 
## Error: trial:plate
##            Df  Sum Sq Mean Sq
## soil_space  1 0.01346 0.01346
## 
## Error: Within
##             Df Sum Sq Mean Sq F value Pr(>F)  
## species      1 0.1354 0.13540   4.898 0.0291 *
## soil_space   1 0.0041 0.00412   0.149 0.7004  
## Residuals  103 2.8474 0.02764                 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# p-value= 0.0291, statistically significant

#Plot
x<-(control_subset$root_length_)
y<-(Cladosporium_sp.data$root_length_)

data <- data.frame(
  Group = rep(c("Control", "Cladosporium_sp."), each = length(x)),
  Value = c(x, y)
)

# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Cladosporium_sp. VS Control Root Length",
       x = "Group",
       y = "Root Length mm") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Cladosporium_sp." = "lightgreen"))

p 


"Didymella_americana"
## [1] "Didymella_americana"
Didymella_americana.data <- subset(Data, species == "Didymella_americana")
summary(Didymella_americana.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length 
##  Length:54          Length:54          Min.   : 9.054   Min.   :0.9568  
##  Class :character   Class :character   1st Qu.:18.033   1st Qu.:1.2560  
##  Mode  :character   Mode  :character   Median :28.211   Median :1.4503  
##                                        Mean   :30.541   Mean   :1.4352  
##                                        3rd Qu.:39.836   3rd Qu.:1.6003  
##                                        Max.   :65.382   Max.   :1.8155  
##  leaf_average_     log_leaf_avg      leaf_count    lateral_roots   
##  Min.   : 2.901   Min.   :0.4625   Min.   :4.000   Min.   : 2.000  
##  1st Qu.: 4.807   1st Qu.:0.6819   1st Qu.:5.250   1st Qu.: 5.250  
##  Median : 7.732   Median :0.8883   Median :6.000   Median : 8.000  
##  Mean   : 7.334   Mean   :0.8382   Mean   :5.648   Mean   : 9.093  
##  3rd Qu.: 9.031   3rd Qu.:0.9556   3rd Qu.:6.000   3rd Qu.:10.000  
##  Max.   :13.024   Max.   :1.1147   Max.   :6.000   Max.   :67.000  
##   stem_length       log_stem     
##  Min.   :1.416   Min.   :0.1511  
##  1st Qu.:1.978   1st Qu.:0.2961  
##  Median :2.292   Median :0.3601  
##  Mean   :2.347   Mean   :0.3601  
##  3rd Qu.:2.696   3rd Qu.:0.4308  
##  Max.   :3.631   Max.   :0.5600
ggqqplot(Didymella_americana.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Didymella_americana.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Didymella_americana.data$log_root_length
## W = 0.97039, p-value = 0.2005
#p-value = 0.2005, does furfill normality assumtions 

anova_result <- aov(log_root_length  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Didymella_americana.data))
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.09203 0.09203               
## 
## Error: trial:plate
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.001228 0.001228               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1  1.013  1.0126   27.93 6.98e-07 ***
## Residuals 104  3.771  0.0363                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value =  6.98e-07 , statistically significant

#Plot
x<-(control_subset$root_length_)
y<-(Didymella_americana.data$root_length_)

data <- data.frame(
  Group = rep(c("Control", "Didymella_americana"), each = length(x)),
  Value = c(x, y)
)

# Boxplot
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Didymella_americana VS Control Root Length",
       x = "Group",
       y = "Root Length mm") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Didymella_americana" = "lightgreen"))

p 


"Filobasidium_floriflorm"
## [1] "Filobasidium_floriflorm"
Filobasidium_floriflorm.data <- subset(Data, species == "Filobasidium_floriflorm")
summary(Filobasidium_floriflorm.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length
##  Length:54          Length:54          Min.   :11.80   Min.   :1.072  
##  Class :character   Class :character   1st Qu.:20.27   1st Qu.:1.307  
##  Mode  :character   Mode  :character   Median :24.02   Median :1.381  
##                                        Mean   :25.40   Mean   :1.385  
##                                        3rd Qu.:31.32   3rd Qu.:1.496  
##                                        Max.   :44.20   Max.   :1.645  
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots   
##  Min.   :3.571   Min.   :0.5527   Min.   :4.000   Min.   : 0.000  
##  1st Qu.:4.410   1st Qu.:0.6444   1st Qu.:5.000   1st Qu.: 6.000  
##  Median :4.827   Median :0.6837   Median :6.000   Median : 8.000  
##  Mean   :4.861   Mean   :0.6821   Mean   :5.444   Mean   : 8.241  
##  3rd Qu.:5.309   3rd Qu.:0.7250   3rd Qu.:6.000   3rd Qu.:10.750  
##  Max.   :7.411   Max.   :0.8699   Max.   :7.000   Max.   :17.000  
##   stem_length       log_stem     
##  Min.   :1.306   Min.   :0.1159  
##  1st Qu.:2.049   1st Qu.:0.3116  
##  Median :2.381   Median :0.3767  
##  Mean   :2.404   Mean   :0.3698  
##  3rd Qu.:2.646   3rd Qu.:0.4226  
##  Max.   :3.670   Max.   :0.5647
ggqqplot(Filobasidium_floriflorm.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Filobasidium_floriflorm.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Filobasidium_floriflorm.data$log_root_length
## W = 0.97136, p-value = 0.2212
#p-value = 0.2212 furfills normality assumtions 

anova_result <- aov(log_root_length  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Filobasidium_floriflorm.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.002502 0.002502               
## 
## Error: trial:plate
##           Df    Sum Sq   Mean Sq F value Pr(>F)
## Residuals  1 0.0001883 0.0001883               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1  0.554  0.5540   24.53 2.84e-06 ***
## Residuals 104  2.349  0.0226                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value=2.84e-06, significantly different

#Plot
x<-(control_subset$root_length_)
y<-(Filobasidium_floriflorm.data$root_length_)

data <- data.frame(
  Group = rep(c("Control", "Filobasidium_floriflorm"), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Filobasidium_floriflorm VS COntrol Root length",
       x = "Group",
       y = "Root Length") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Filobasidium_floriflorm" = "lightgreen"))

p 


"Fusarium_equiseti"
## [1] "Fusarium_equiseti"
Fusarium_equiseti.data <- subset(Data, species == "Fusarium_equiseti")
summary(Fusarium_equiseti.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length 
##  Length:54          Length:54          Min.   : 7.576   Min.   :0.8794  
##  Class :character   Class :character   1st Qu.:12.081   1st Qu.:1.0821  
##  Mode  :character   Mode  :character   Median :14.280   Median :1.1547  
##                                        Mean   :15.041   Mean   :1.1638  
##                                        3rd Qu.:17.196   3rd Qu.:1.2354  
##                                        Max.   :25.450   Max.   :1.4057  
##  leaf_average_    log_leaf_avg      leaf_count   lateral_roots  stem_length   
##  Min.   :1.928   Min.   :0.2851   Min.   :4.00   Min.   : 2    Min.   :0.888  
##  1st Qu.:2.873   1st Qu.:0.4583   1st Qu.:4.00   1st Qu.: 4    1st Qu.:1.627  
##  Median :3.449   Median :0.5377   Median :5.00   Median : 6    Median :1.855  
##  Mean   :3.553   Mean   :0.5366   Mean   :4.87   Mean   : 7    Mean   :1.848  
##  3rd Qu.:4.201   3rd Qu.:0.6233   3rd Qu.:6.00   3rd Qu.: 9    3rd Qu.:2.109  
##  Max.   :6.246   Max.   :0.7956   Max.   :6.00   Max.   :16    Max.   :3.299  
##     log_stem       
##  Min.   :-0.05159  
##  1st Qu.: 0.21139  
##  Median : 0.26833  
##  Mean   : 0.25393  
##  3rd Qu.: 0.32408  
##  Max.   : 0.51838
summary(control_subset)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length
##  Length:54          Length:54          Min.   : 8.128   Min.   :0.910  
##  Class :character   Class :character   1st Qu.:13.794   1st Qu.:1.140  
##  Mode  :character   Mode  :character   Median :17.407   Median :1.241  
##                                        Mean   :18.637   Mean   :1.242  
##                                        3rd Qu.:21.004   3rd Qu.:1.322  
##                                        Max.   :34.876   Max.   :1.543  
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots   
##  Min.   :3.462   Min.   :0.5393   Min.   :4.000   Min.   : 2.000  
##  1st Qu.:3.988   1st Qu.:0.6008   1st Qu.:4.000   1st Qu.: 5.000  
##  Median :4.497   Median :0.6529   Median :6.000   Median : 7.000  
##  Mean   :4.586   Mean   :0.6563   Mean   :5.222   Mean   : 7.093  
##  3rd Qu.:5.244   3rd Qu.:0.7197   3rd Qu.:6.000   3rd Qu.: 9.000  
##  Max.   :5.962   Max.   :0.7754   Max.   :6.000   Max.   :15.000  
##   stem_length       log_stem       
##  Min.   :1.005   Min.   :0.002166  
##  1st Qu.:1.842   1st Qu.:0.265289  
##  Median :2.119   Median :0.326130  
##  Mean   :2.162   Mean   :0.323987  
##  3rd Qu.:2.419   3rd Qu.:0.383591  
##  Max.   :3.368   Max.   :0.527372
ggqqplot(Fusarium_equiseti.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Fusarium_equiseti.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Fusarium_equiseti.data$log_root_length
## W = 0.98573, p-value = 0.7655
#  p-value =  0.7655, does  fulfill normality assumptions.

anova_result <- aov(log_root_length  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Fusarium_equiseti.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.03036 0.03036               
## 
## Error: trial:plate
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.003929 0.003929               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value  Pr(>F)   
## species     1 0.1632 0.16325   8.655 0.00402 **
## Residuals 104 1.9617 0.01886                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value=  0.00402, significantly different

#Plot
data <- data.frame(
  Group = rep(c("Control", "Fusarium_equiseti"), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Fusarium_equiseti VS Control Root Length",
       x = "Group",
       y = "Root Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        legend.title = element_text(size = 10),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue","Fusarium_equiseti" = "lightgreen"))


p 


'Naganishia_albidus'
## [1] "Naganishia_albidus"
Naganishia_albidus.data <- subset(Data, species == "Naganishia_albidus")
summary(Naganishia_albidus.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length 
##  Length:54          Length:54          Min.   : 9.227   Min.   :0.9651  
##  Class :character   Class :character   1st Qu.:18.879   1st Qu.:1.2760  
##  Mode  :character   Mode  :character   Median :28.444   Median :1.4539  
##                                        Mean   :28.930   Mean   :1.4220  
##                                        3rd Qu.:38.758   3rd Qu.:1.5884  
##                                        Max.   :53.584   Max.   :1.7290  
##  leaf_average_    log_leaf_avg      leaf_count   lateral_roots   
##  Min.   :3.183   Min.   :0.5028   Min.   :4.00   Min.   : 2.000  
##  1st Qu.:4.381   1st Qu.:0.6416   1st Qu.:6.00   1st Qu.: 4.000  
##  Median :4.812   Median :0.6823   Median :6.00   Median : 6.000  
##  Mean   :5.109   Mean   :0.6988   Mean   :5.87   Mean   : 7.148  
##  3rd Qu.:5.936   3rd Qu.:0.7735   3rd Qu.:6.00   3rd Qu.: 8.000  
##  Max.   :8.018   Max.   :0.9040   Max.   :7.00   Max.   :17.000  
##   stem_length       log_stem     
##  Min.   :1.584   Min.   :0.1998  
##  1st Qu.:2.165   1st Qu.:0.3355  
##  Median :2.438   Median :0.3871  
##  Mean   :2.521   Mean   :0.3920  
##  3rd Qu.:2.847   3rd Qu.:0.4544  
##  Max.   :3.891   Max.   :0.5901
ggqqplot(Naganishia_albidus.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Naganishia_albidus.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Naganishia_albidus.data$log_root_length
## W = 0.92743, p-value = 0.00289
# p-value = 0.00402, does not furfills normality assumtions 

wilcox_test <- wilcox.test(log_root_length  ~ species, data = rbind(control_subset, Naganishia_albidus.data))
print(wilcox_test)
## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  log_root_length by species
## W = 688, p-value = 2.266e-06
## alternative hypothesis: true location shift is not equal to 0
# p-value= 2.266e-06

#Plot
x<-(control_subset$root_length_)
y<-(Naganishia_albidus.data$root_length_)

data <- data.frame(
  Group = rep(c("Control", "Naganishia_albidus"), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Naganishia_albidus VS Control Root Length",
       x = "Group",
       y = "Root Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Naganishia_albidus" = "lightgreen"))

p 


"Subramaniula_cuniculorum"
## [1] "Subramaniula_cuniculorum"
Subramaniula_cuniculorum.data <- subset(Data, species == "Subramaniula_c.")
summary(Subramaniula_cuniculorum.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length
##  Length:54          Length:54          Min.   :12.73   Min.   :1.105  
##  Class :character   Class :character   1st Qu.:21.33   1st Qu.:1.329  
##  Mode  :character   Mode  :character   Median :25.57   Median :1.408  
##                                        Mean   :25.93   Mean   :1.397  
##                                        3rd Qu.:29.10   3rd Qu.:1.464  
##                                        Max.   :42.50   Max.   :1.628  
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots  
##  Min.   :3.780   Min.   :0.5774   Min.   :4.000   Min.   :0.000  
##  1st Qu.:4.540   1st Qu.:0.6571   1st Qu.:5.000   1st Qu.:2.000  
##  Median :5.136   Median :0.7106   Median :6.000   Median :3.000  
##  Mean   :5.542   Mean   :0.7313   Mean   :5.426   Mean   :3.204  
##  3rd Qu.:6.120   3rd Qu.:0.7867   3rd Qu.:6.000   3rd Qu.:4.000  
##  Max.   :9.502   Max.   :0.9778   Max.   :6.000   Max.   :8.000  
##   stem_length       log_stem       
##  Min.   :1.006   Min.   :0.002598  
##  1st Qu.:1.919   1st Qu.:0.283010  
##  Median :2.437   Median :0.386746  
##  Mean   :2.572   Mean   :0.380294  
##  3rd Qu.:3.039   3rd Qu.:0.482802  
##  Max.   :7.868   Max.   :0.895864
ggqqplot(Subramaniula_cuniculorum.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Subramaniula_cuniculorum.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Subramaniula_cuniculorum.data$log_root_length
## W = 0.95844, p-value = 0.05865
# p-value = 0.05865 does  furfill normality assumtions 

anova_result <- aov(log_root_length  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Subramaniula_cuniculorum.data))
 #rbind combines the two subsets 
 #This code includes the nested factors (trial and plate) as random effects
 summary(anova_result)
## 
## Error: trial
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.009019 0.009019               
## 
## Error: trial:plate
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.001045 0.001045               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1  0.651   0.651   30.93 2.09e-07 ***
## Residuals 104  2.189   0.021                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value=2.09e-07
 
x<-(control_subset$root_length_)
y<-(Subramaniula_cuniculorum.data$root_length_)


#Plot
data <- data.frame(
  Group = rep(c("Control", "Subramaniula_cuniculorum"), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Subramaniula_cuniculorum VS Control Root Length",
       x = "Group",
       y = "Root Length") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Subramaniula_cuniculorum" = "lightgreen"))

p 


"Westerdykella_centenaria"
## [1] "Westerdykella_centenaria"
Westerdykella_centenaria.data <- subset(Data, species == "Westerdykella_centenaria")
summary(Westerdykella_centenaria.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length 
##  Length:54          Length:54          Min.   : 0.00   Min.   :0.8782  
##  Class :character   Class :character   1st Qu.:12.57   1st Qu.:1.1022  
##  Mode  :character   Mode  :character   Median :18.32   Median :1.2702  
##                                        Mean   :20.26   Mean   :1.2710  
##                                        3rd Qu.:25.97   3rd Qu.:1.4145  
##                                        Max.   :45.79   Max.   :1.6608  
##  leaf_average_     log_leaf_avg      leaf_count    lateral_roots   
##  Min.   : 2.412   Min.   :0.3824   Min.   :4.000   Min.   : 2.000  
##  1st Qu.: 4.170   1st Qu.:0.6202   1st Qu.:6.000   1st Qu.: 4.250  
##  Median : 4.947   Median :0.6943   Median :6.000   Median : 7.000  
##  Mean   : 5.065   Mean   :0.6846   Mean   :5.611   Mean   : 6.944  
##  3rd Qu.: 5.450   3rd Qu.:0.7364   3rd Qu.:6.000   3rd Qu.: 8.750  
##  Max.   :10.015   Max.   :1.0007   Max.   :6.000   Max.   :15.000  
##   stem_length       log_stem     
##  Min.   :1.363   Min.   :0.1345  
##  1st Qu.:1.840   1st Qu.:0.2648  
##  Median :2.134   Median :0.3292  
##  Mean   :2.120   Mean   :0.3194  
##  3rd Qu.:2.374   3rd Qu.:0.3754  
##  Max.   :3.179   Max.   :0.5023
ggqqplot(Westerdykella_centenaria.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Westerdykella_centenaria.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Westerdykella_centenaria.data$log_root_length
## W = 0.97857, p-value = 0.4416
# p-value = 0.4416,furfills normality assumtions 

anova_result <- aov(log_root_length  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Westerdykella_centenaria.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.05555 0.05555               
## 
## Error: trial:plate
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.008564 0.008564               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value Pr(>F)
## species     1  0.023 0.02340   0.723  0.397
## Residuals 104  3.365 0.03236
#p-value= 0.397, no significant difference 
"Phoma sp. 301"
## [1] "Phoma sp. 301"
Phoma_sp301.data <- subset(Data, species_ID == "301ci57")
summary(Phoma_sp301.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_   log_root_length
##  Length:54          Length:54          Min.   :10.83   Min.   :1.035  
##  Class :character   Class :character   1st Qu.:19.00   1st Qu.:1.279  
##  Mode  :character   Mode  :character   Median :24.94   Median :1.397  
##                                        Mean   :25.08   Mean   :1.374  
##                                        3rd Qu.:30.72   3rd Qu.:1.487  
##                                        Max.   :46.63   Max.   :1.669  
##  leaf_average_    log_leaf_avg      leaf_count    lateral_roots   
##  Min.   :3.318   Min.   :0.5209   Min.   :4.000   Min.   :  3.00  
##  1st Qu.:4.766   1st Qu.:0.6782   1st Qu.:5.000   1st Qu.:  6.00  
##  Median :5.738   Median :0.7587   Median :6.000   Median :  8.00  
##  Mean   :5.879   Mean   :0.7547   Mean   :5.667   Mean   : 22.83  
##  3rd Qu.:6.823   3rd Qu.:0.8340   3rd Qu.:6.000   3rd Qu.:  9.00  
##  Max.   :9.755   Max.   :0.9892   Max.   :7.000   Max.   :812.00  
##   stem_length       log_stem      
##  Min.   :1.077   Min.   :0.03222  
##  1st Qu.:1.657   1st Qu.:0.21942  
##  Median :1.895   Median :0.27772  
##  Mean   :1.965   Mean   :0.27984  
##  3rd Qu.:2.192   3rd Qu.:0.34079  
##  Max.   :3.306   Max.   :0.51930
ggqqplot(Phoma_sp301.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Phoma_sp301.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Phoma_sp301.data$log_root_length
## W = 0.96564, p-value = 0.1234
# p-value= 0.5435 furfills normality assumtions 

anova_result <- aov(log_root_length  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Phoma_sp301.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.1044  0.1044               
## 
## Error: trial:plate
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.03014 0.03014               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value   Pr(>F)    
## species     1 0.4736  0.4736   19.74 2.22e-05 ***
## Residuals 104 2.4950  0.0240                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# p-value= 2.22e-05, significantly different.


#Plot
x<-(control_subset$root_length_)
y<-(Phoma_sp301.data$root_length_)

data <- data.frame(
  Group = rep(c("Control", "Phoma_sp301.data"), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Phoma VS Control Root Length",
       x = "Group",
       y = "Root Length") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Phoma_sp301" = "lightgreen"))


p 


"Phoma sp._313"
## [1] "Phoma sp._313"
Phoma_sp313.data <- subset(Data, species_ID == "313dri103")
summary(Phoma_sp313.data)
##    microbe_          soil_space            trial       plate   seed_replicate
##  Length:54          Length:54          Min.   :1   Min.   :1   Min.   :1.0   
##  Class :character   Class :character   1st Qu.:1   1st Qu.:1   1st Qu.:2.0   
##  Mode  :character   Mode  :character   Median :2   Median :2   Median :3.5   
##                                        Mean   :2   Mean   :2   Mean   :3.5   
##                                        3rd Qu.:3   3rd Qu.:3   3rd Qu.:5.0   
##                                        Max.   :3   Max.   :3   Max.   :6.0   
##    species           species_ID         root_length_    log_root_length 
##  Length:54          Length:54          Min.   : 7.576   Min.   :0.8794  
##  Class :character   Class :character   1st Qu.:12.081   1st Qu.:1.0821  
##  Mode  :character   Mode  :character   Median :14.280   Median :1.1547  
##                                        Mean   :15.041   Mean   :1.1638  
##                                        3rd Qu.:17.196   3rd Qu.:1.2354  
##                                        Max.   :25.450   Max.   :1.4057  
##  leaf_average_    log_leaf_avg      leaf_count   lateral_roots  
##  Min.   :1.953   Min.   :0.2907   Min.   :4.00   Min.   :0.000  
##  1st Qu.:2.710   1st Qu.:0.4330   1st Qu.:4.00   1st Qu.:1.000  
##  Median :3.011   Median :0.4787   Median :6.00   Median :2.000  
##  Mean   :3.155   Mean   :0.4893   Mean   :5.37   Mean   :2.056  
##  3rd Qu.:3.452   3rd Qu.:0.5381   3rd Qu.:6.00   3rd Qu.:3.000  
##  Max.   :5.596   Max.   :0.7478   Max.   :7.00   Max.   :7.000  
##   stem_length        log_stem       
##  Min.   :0.6870   Min.   :-0.16304  
##  1st Qu.:0.9597   1st Qu.:-0.01794  
##  Median :1.2395   Median : 0.09324  
##  Mean   :1.3721   Mean   : 0.10114  
##  3rd Qu.:1.4500   3rd Qu.: 0.16136  
##  Max.   :4.8870   Max.   : 0.68904
ggqqplot(Phoma_sp313.data$log_root_length ) 


#draws the correlation between a given sample and the normal distribution.
shapiro.test(Phoma_sp313.data$log_root_length )
## 
##  Shapiro-Wilk normality test
## 
## data:  Phoma_sp313.data$log_root_length
## W = 0.98573, p-value = 0.7655
#P-value= p-value = 0.7655 Does furfill normality assumtions 

anova_result <- aov(log_root_length  ~ species + soil_space + Error(trial/plate), data = rbind(control_subset, Phoma_sp313.data))
#rbind combines the two subsets 
#This code includes the nested factors (trial and plate) as random effects
summary(anova_result)
## 
## Error: trial
##           Df  Sum Sq Mean Sq F value Pr(>F)
## Residuals  1 0.03036 0.03036               
## 
## Error: trial:plate
##           Df   Sum Sq  Mean Sq F value Pr(>F)
## Residuals  1 0.003929 0.003929               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value  Pr(>F)   
## species     1 0.1632 0.16325   8.655 0.00402 **
## Residuals 104 1.9617 0.01886                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#p-value=0.00402, significantly different

#Plot
x<-(control_subset$root_length_)
y<-(Phoma_sp313.data $root_length_)


data <- data.frame(
  Group = rep(c("Control", "Phoma sp."), each = length(x)),
  Value = c(x, y)
)

# Boxplot with significance level
p <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +
  geom_boxplot() +
  labs(title = "Phoma sp. VS Control Root Length",
       x = "Group",
       y = "Root Length (mm)") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        axis.title.x = element_text(size = 10),
        axis.title.y = element_text(size = 10),
        legend.title = element_text(size = 10),
        legend.text = element_text(size = 10)) +
  scale_fill_manual(values = c("Control" = "lightblue", "Phoma sp.313" = "lightgreen"))


p  


# Sample data structure
# data <- data.frame(
#   species = rep(c("Species1", "Species2", "Species3"), each = 10),
#   leaf_length = rnorm(30, mean = 5, sd = 2),
#   group = rep(c("Control", "Test"), each = 15),
#   type_of_microbe = rep(c("Bacteria", "Fungi"), each = 15)
# )

# Load necessary libraries
library(dplyr)

# Generate summary statistics
summary_data <- Data %>%
  group_by(soil_space, species, microbe_) %>%
  summarise(
    mean_root_length_ = mean(root_length_),
    se_leaf_length = sd(root_length__) / sqrt(n()),
    .groups = 'drop'
  )

# Print the summary table
print(summary_data)
# Export the summary table to a CSV file
write.csv(summary_data, "summary_table.csv", row.names = FALSE)
```
